import { Part, ContentType } from '../../types';

export const part4Content: Part = {
  id: "p4",
  partTitle: "ุงูุจุงุจ ุงูุฑุงุจุน: ุงูุฃูุงู ูุงูุชุญุตูู ุงููุชูุฏู",
  icon: "๐ก๏ธ",
  chapters: [
     {
        id: "p4_c1", chapterTitle: "ุงููุตู ุงูุณุงุฏุณ ุนุดุฑ: ุชุฃููู Nginx ุจู SSL/TLS",
        sections: [
            {
              id: "p4_c1_s1",
              icon: "๐",
              title: "ุงููุณุชูู 75: ูุดู ุฎุจุงูุง HTTPS ููุตุงูุญุฉ TLS",
              content: [
                { type: ContentType.PARAGRAPH, text: "ุญุชู ุงูุขูุ ูู ุญุฑูุฉ ุงููุฑูุฑ ุจูู ูุณุชุฎุฏูููุง ูุฎุงุฏููุง ุชูุชูู ููุต ุนุงุฏู ุนุจุฑ ุจุฑูุชูููู HTTP. ูุฐุง ูุนูู ุฃู ุฃู ุดุฎุต ุนูู ุงูุดุจูุฉ (ูุซู ูุฒูุฏ ุฎุฏูุฉ ุงูุฅูุชุฑูุชุ ุฃู ุดุฎุต ุนูู ููุณ ุดุจูุฉ Wi-Fi ุงูุนุงูุฉ) ููููู ุงุนุชุฑุงุถ ููุฑุงุกุฉ ูู ุดูุก: ูููุงุช ุงููุฑูุฑุ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉุ ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ููุฌูุณุงุช. ูู ุนุงูู ุงููููุ ูุฐุง ุบูุฑ ููุจูู ุนูู ุงูุฅุทูุงู. ุงูุญู ูู HTTPS (ุจุฑูุชูููู ููู ุงููุต ุงููุงุฆู ุงูุขูู)." },
                { type: ContentType.PARAGRAPH, text: "HTTPS ูู ุจุจุณุงุทุฉ HTTP ูุน ุทุจูุฉ ุฃูุงู ุฅุถุงููุฉ ูููู ุชุณูู TLS (Transport Layer Security)ุ ูุงูุชู ูุงูุช ุชูุนุฑู ุณุงุจููุง ุจุงุณู SSL (Secure Sockets Layer). TLS ูููุฑ ุซูุงุซ ุถูุงูุงุช ุฃูููุฉ ุญูููุฉ:" },
                { type: ContentType.DEFINITION_LIST, definitionItems: [
                    { term: "ุงูุชุดููุฑ (Encryption)", definition: "ูุชู ุชุดููุฑ ุฌููุน ุงูุจูุงูุงุช ุงููุชุจุงุฏูุฉ ุจูู ุงููุชุตูุญ ูุงูุฎุงุฏู. ุฅุฐุง ุงุนุชุฑุถูุง ุฃู ุดุฎุตุ ูุณูุฑุงูุง ูุจูุงูุงุช ุนุดูุงุฆูุฉ ุบูุฑ ูุงุจูุฉ ูููุฑุงุกุฉ ุจุฏูู ููุชุงุญ ูู ุงูุชุดููุฑ." },
                    { term: "ุงููุตุงุฏูุฉ (Authentication)", definition: "ูุณุชุฎุฏู ุงูุฎุงุฏู ุดูุงุฏุฉ SSL/TLS ููุซุจุช ูููุชุตูุญ ุฃูู ูู ุงูุฎุงุฏู ุงูุญูููู ูู `your_domain.com` ูููุณ ููุชุญูุงู. ูุฐุง ูููุน ูุฌูุงุช 'ุงููุณูุท' (Man-in-the-Middle)." },
                    { term: "ุงูุณูุงูุฉ (Integrity)", definition: "ูุชู ุงูุชุญูู ูู ุฃู ุงูุจูุงูุงุช ูู ูุชู ุชุนุฏูููุง ุฃู ุงูุนุจุซ ุจูุง ุฃุซูุงุก ุงูููู. ูุชู ุฅุฑูุงู ุชูููุน ุฑููู ูุน ูู ุฑุณุงูุฉุ ูุฃู ุชุบููุฑ ุจุณูุท ุณูุคุฏู ุฅูู ูุดู ุงูุชุญูู ูู ุงูุชูููุน." }
                ]},
                { type: ContentType.HEADING4, text: "ูุฑุดุฉ ุนูู: ุชุดุฑูุญ ูุตุงูุญุฉ TLS (TLS Handshake)"},
                { type: ContentType.PARAGRAPH, text: "ุนูุฏูุง ุชุชุตู ุจู `https://google.com`ุ ุชุญุฏุซ 'ุฑูุตุฉ' ูุนูุฏุฉ ูู ุฃุฌุฒุงุก ูู ุงูุซุงููุฉ ุชุณูู ูุตุงูุญุฉ TLS. ุฅููู ูุณุฎุฉ ูุจุณุทุฉ ููุง ูุญุฏุซ ุฎูู ุงูููุงููุณุ ุฎุทูุฉ ุจุฎุทูุฉ:"},
                { type: ContentType.LIST_UNORDERED, items: [
                    "<strong>1. ุงูุนููู ูููู ูุฑุญุจุงู (Client Hello):</strong> ูููู ูุชุตูุญู ููุฎุงุฏู: 'ูุฑุญุจุงูุ ุฃุฑูุฏ ุจุฏุก ุงุชุตุงู ุขูู. ูุฐู ูู ุฅุตุฏุงุฑุงุช TLS ุงูุชู ุฃุฏุนููุง ููุฐู ูู ูุฌููุนุงุช ุงูุชุดููุฑ ุงูุชู ุฃุนุฑููุง.'",
                    "<strong>2. ุงูุฎุงุฏู ูุฑุฏ ุงูุชุญูุฉ (Server Hello):</strong> ูุฑุฏ ุงูุฎุงุฏู: 'ูุฑุญุจุงู ุฃูุถุงู. ููุฏ ุงุฎุชุฑุช ุฃููู ุฅุตุฏุงุฑ TLS ููุฌููุนุฉ ุชุดููุฑ ูุฏุนููุง ููุงูุง. ุฅููู ุดูุงุฏุชู ุงูุนุงูุฉ (Public Certificate).' ูุฐู ุงูุดูุงุฏุฉ ุชุญุชูู ุนูู ุงูููุชุงุญ ุงูุนุงู ููุฎุงุฏู ููููุนุฉ ูู ูุจู ููุฆุฉ ุฅุตุฏุงุฑ ุดูุงุฏุงุช (CA) ููุซููุฉ.",
                    "<strong>3. ุงููุชุตูุญ ูุชุญูู ูู ุงููููุฉ:</strong> ูุชุญูู ูุชุตูุญู ูู ุชูููุน ุงูุดูุงุฏุฉ ููุงุจู ูุงุฆูุฉ ููุฆุงุช ุฅุตุฏุงุฑ ุงูุดูุงุฏุงุช ุงูููุซููุฉ ุงููุฏูุฌุฉ ููู (ูุซู DigiCert, GlobalSign). ุฅุฐุง ูุงูุช ุงูุดูุงุฏุฉ ููุซููุฉ ูุตุงูุญุฉ ูููุทุงู ุงููุทููุจุ ูุฅูู ูุนูู ุฃูู ูุชุญุฏุซ ุฅูู ุงูุฎุงุฏู ุงูุญูููู.",
                    "<strong>4. ุชุจุงุฏู ุงูููุงุชูุญ ุงูุณุฑู:</strong> ููุดุฆ ุงููุชุตูุญ 'ุณุฑูุง ูุดุชุฑููุง' ุฌุฏูุฏูุง ููุฑูุฏูุง ููุฐู ุงูุฌูุณุฉ (ููุชุงุญ ุฌูุณุฉ ูุชูุงุซู). ูููู ุจุชุดููุฑ ูุฐุง ุงูุณุฑ ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุนุงู ููุฎุงุฏู (ุงูุฐู ุญุตู ุนููู ูู ุงูุดูุงุฏุฉ) ููุฑุณูู ูุฑุฉ ุฃุฎุฑู. ููุท ุงูุฎุงุฏูุ ุจููุชุงุญู ุงูุฎุงุต ุงูููุงุจูุ ููููู ูู ุชุดููุฑ ูุฐุง ุงูุณุฑ.",
                    "<strong>5. ุชู ุงูุชุดููุฑ!:</strong> ุงูุขูุ ููุชูู ูู ูู ุงููุชุตูุญ ูุงูุฎุงุฏู ููุณ ููุชุงุญ ุงูุฌูุณุฉ ุงูุณุฑู. ูุณุชุฎุฏููู ูุฐุง ุงูููุชุงุญ ูุชุดููุฑ ููู ุชุดููุฑ ุฌููุน ุงูุจูุงูุงุช ุงููุงุญูุฉ ูู ูุฐู ุงูุฌูุณุฉ. ูุฐุง ุงูุชุดููุฑ ุงููุชูุงุซู ุฃุณุฑุน ุจูุซูุฑ ูู ุงูุชุดููุฑ ุบูุฑ ุงููุชูุงุซู ุงููุณุชุฎุฏู ูู ุงูุจุฏุงูุฉ."
                ]},
                { type: ContentType.NOTE, title: "ุฃูุซุฑ ูู ูุฌุฑุฏ ุฃูุงู", text: "ูู ุนุงู 2024ุ ูู ูุนุฏ HTTPS ุฎูุงุฑูุง. ูุชุตูุญุงุช ุงูููุจ ุงูุญุฏูุซุฉ ูุซู Chrome ู Firefox ุชุญุฐุฑ ุงููุณุชุฎุฏููู ุจูุถูุญ ูู ุงูููุงูุน ุงูุชู ูุง ุชุณุชุฎุฏู HTTPS ูุชุตููุง ุจุฃููุง 'ุบูุฑ ุขููุฉ'. ุนูุงูุฉ ุนูู ุฐููุ ุชุนุทู ูุญุฑูุงุช ุงูุจุญุซ ูุซู Google ุฏูุนุฉ ูู ุงูุชุฑุชูุจ ููููุงูุน ุงูุชู ุชุณุชุฎุฏู HTTPS. ูุฐุงุ ูุฅู ุชูููู HTTPS ุถุฑูุฑู ููุซูุฉ ูุงูุฃูุงู ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ูุชุญุณูู ูุญุฑูุงุช ุงูุจุญุซ (SEO)." },
              ]
            },
            {
              id: "p4_c1_s2",
              icon: "๐",
              title: "ุงููุณุชูู 76: ูุฑุดุฉ ุนูู Certbot: ุฃุชูุชุฉ ุงูุชุดููุฑ",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูู ุงููุงุถูุ ูุงู ุงูุญุตูู ุนูู ุดูุงุฏุฉ SSL ุนูููุฉ ููููุฉ ููุนูุฏุฉ ุชุชุทูุจ ูุนุฑูุฉ ุชูููุฉ. ููุฏ ุบูุฑุช Let's Encryptุ ููู ููุฆุฉ ุฅุตุฏุงุฑ ุดูุงุฏุงุช ูุฌุงููุฉ ูุขููุฉ ูููุชูุญุฉุ ูู ุฐูู. Certbot ูู ุงูุฃุฏุงุฉ (ุงูุนููู) ุงูุชู ูุณุชุฎุฏููุง ุนูู ุฎุงุฏููุง ููุชูุงุนู ูุน Let's Encrypt ูุงูุญุตูู ุนูู ูุฐู ุงูุดูุงุฏุงุช ุงููุฌุงููุฉ ูุชุซุจูุชูุง." },
                { type: ContentType.HEADING4, text: "ูุดู ุฎุจุงูุง ุจุฑูุชูููู ACME" },
                { type: ContentType.PARAGRAPH, text: "ูุนูู Certbot ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู ูุณูู ACME (Automated Certificate Management Environment). ACME ูู ุจุฑูุชูููู ุงุชุตุงู ูุณูุญ ูู Certbot (ุนูู ุฎุงุฏูู) ุจุงูุชุญุฏุซ ูุน Let's Encrypt (ุงูู CA) ูุฅุซุจุงุช ุฃูู ุชุณูุทุฑ ุจุงููุนู ุนูู ูุทุงููุ ููู ุซู ุฅุตุฏุงุฑ ุดูุงุฏุฉ ูู. ุงูุฌุฒุก ุงูุฃูุซุฑ ุฃูููุฉ ูู 'ุงูุชุญุฏู' (Challenge)." },
                { type: ContentType.DEFINITION_LIST, definitionItems: [
                    { term: "ุชุญุฏู HTTP-01 (ุงูุฃูุซุฑ ุดููุนูุง)", definition: "ูุฐุง ูู ูุง ูุณุชุฎุฏูู `certbot --nginx`. 1) ูุฎุจุฑ Certbot Let's Encrypt: 'ุฃุฑูุฏ ุดูุงุฏุฉ ูู `your_domain.com`'. 2) ูุฑุฏ Let's Encrypt: 'ุจุงูุชุฃููุฏ. ูุฅุซุจุงุช ุฃูู ุชููู ูุฐุง ุงููุทุงูุ ูู ุจุฅูุดุงุก ููู ูุญุชูู ุนูู ูุฐุง ุงูุฑูุฒ ุงูุณุฑู ุงูุนุดูุงุฆู `XYZ` ูุงุฌุนูู ูุชุงุญูุง ุนูู `http://your_domain.com/.well-known/acme-challenge/XYZ`'. 3) ูููู Certbot ุจุฅูุดุงุก ูุฐุง ุงูููู ูุคูุชูุง ุนูู ุฎุงุฏู Nginx ุงูุฎุงุต ุจู. 4) ูุฎุจุฑ Let's Encrypt: 'ุฃูุง ุฌุงูุฒ'. 5) ูุญุงูู ุฎุงุฏู Let's Encrypt ุชูุฒูู ุงูููู ูู ูุฐุง ุงูุนููุงู. ุฅุฐุง ูุฌุญ ูุชุทุงุจู ุงูุฑูุฒ ุงูุณุฑูุ ููุฐุง ูุซุจุช ุฃูู ุชุณูุทุฑ ุนูู ุงูุฎุงุฏูุ ููุชู ุฅุตุฏุงุฑ ุงูุดูุงุฏุฉ." },
                    { term: "ุชุญุฏู DNS-01", definition: "ูุณุชุฎุฏู ูุฐุง ุนูุฏูุง ูุง ูููู ุงููููุฐ 80 ููุชูุญูุง ุฃู ูููุทุงูุงุช ุงูุจุฏู (`*.your_domain.com`). ููุงุ ูุทูุจ ููู Let's Encrypt ุฅูุดุงุก ุณุฌู TXT ูุนูู ูู ุฅุนุฏุงุฏุงุช DNS ููุทุงูู. ูุฐุง ูุชุทูุจ ุฃู ูููู ูุฏู Certbot ูุตูู API ุฅูู ูุฒูุฏ DNS ุงูุฎุงุต ุจูุ ููุง ูุฌุนูู ุฃูุซุฑ ุชุนููุฏูุง ูู ุงูุฅุนุฏุงุฏ." }
                ]},
                { type: ContentType.HEADING4, text: "ูุฑุดุฉ ุนูู ุงูุชุซุจูุช ูุงูุชุดุบูู"},
                { type: ContentType.PARAGRAPH, text: "ุชุซุจูุช Certbot ุนุจุฑ snap ูุถูู ุฃูู ุชุญุตู ุฏุงุฆููุง ุนูู ุฃุญุฏุซ ุฅุตุฏุงุฑ. ุงูุฃูุฑ ุงูุฑุฆูุณู ูููู ุจูู ุงูุณุญุฑ:"},
                { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot
sudo certbot --nginx -d your_domain.com -d www.your_domain.com`},
                { type: ContentType.PARAGRAPH, text: "ุณูููู ูุฐุง ุงูุฃูุฑ ุจุงูุชุญุฏุซ ุฅูู Nginxุ ูุงูุนุซูุฑ ุนูู ูุชูุฉ ุงูุฎุงุฏู ุงูุตุญูุญุฉุ ูุชุนุฏูููุง ูุคูุชูุง ูุฅููุงู ุชุญุฏู HTTP-01ุ ุซู ุงูุญุตูู ุนูู ุงูุดูุงุฏุฉุ ูุชุซุจูุชูุงุ ูุฅุนุงุฏุฉ ุชุญููู Nginx. ูู ุฐูู ูู ุฎุทูุฉ ูุงุญุฏุฉ." },
                { type: ContentType.HEADING4, text: "ูุฑุดุฉ ุนูู ุชุตุญูุญ ุงูุฃุฎุทุงุก: ููุงุฐุง ูุดู ุงูุชุฌุฏูุฏุ"},
                { type: ContentType.PARAGRAPH, text: "ุฃูุซุฑ ุณุจุจูู ุดููุนูุง ููุดู ุชุฌุฏูุฏ Certbot ููุง:"},
                { type: ContentType.LIST_UNORDERED, items: [
                    "<strong>ููุงุนุฏ ุฌุฏุงุฑ ุงูุญูุงูุฉ:</strong> ุชุฃูุฏ ูู ุฃู ุงููููุฐ 80 ููุชูุญ ุฏุงุฆููุง ููุนุงูู. Let's Encrypt ูุญุชุงุฌ ุฅูู ุงููุตูู ุฅููู ูุฅุฌุฑุงุก ุชุญุฏู HTTP-01. ุญุชู ูู ููุช ุชุนูุฏ ุชูุฌูู ูู ุดูุก ุฅูู 443ุ ูุฌุจ ุฃู ูุธู ุงููููุฐ 80 ููุชูุญูุง.",
                    "<strong>ูุดุงูู IPv6:</strong> ุฅุฐุง ูุงู ูุทุงูู ูุญุชูู ุนูู ุณุฌู AAAA (IPv6) ูู DNS ููููู ูุง ูุณุชูุน ุจุดูู ุตุญูุญ ุนูู IPv6 ุนูู ุฎุงุฏููุ ููุฏ ูุญุงูู Let's Encrypt ุงูุชุญูู ุนุจุฑ IPv6 ูููุดู. ุชุฃูุฏ ูู ุฃู Nginx ุงูุฎุงุต ุจู ูุณุชูุน ุนูู ูู ูู IPv4 ู IPv6 (`listen [::]:80;`)."
                ]},
              ]
            },
            {
              id: "p4_c1_s3",
              icon: "โ๏ธ",
              title: "ุงููุณุชูู 77: ุชุดุฑูุญ ุชูููู Nginx ุงูุฐู ุฃูุดุฃู Certbot",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูููู `certbot --nginx` ุจุชุนุฏูู ููู ุชูููู Nginx ุงูุฎุงุต ุจู ุชููุงุฆููุง. ููู ูุฐู ุงูุชุบููุฑุงุช ูุฒูู ุงูุบููุถ ููููุญู ุงููุฏุฑุฉ ุนูู ุชุฎุตูุต ุงูุชูููู. ููุฏ ุชู ุชูุณูู ูููู ุงูุฃุตูู ุฅูู ูุชูุชูู `server`." },
                { type: ContentType.HEADING4, text: "ูุชูุฉ ุงูุฎุงุฏู ุงูุฃููู: ุฅุนุงุฏุฉ ุงูุชูุฌูู ุงูุฏุงุฆู ูู HTTP ุฅูู HTTPS" },
                { type: ContentType.CODE_EXPLANATION, language: "nginx", codeTitle: "ูุชูุฉ ุฅุนุงุฏุฉ ุงูุชูุฌูู", code: `server {
    listen 80;
    listen [::]:80;
    server_name your_domain.com www.your_domain.com;
    
    # This block is added by Certbot for renewals
    location /.well-known/acme-challenge/ {
        root /var/www/html;
    }

    location / {
        return 301 https://$host$request_uri;
    }
}`, explanations: [
                    { lines: "7-9", explanation: "ูุฐู ุงููุชูุฉ ูููุฉ. ุฅููุง ุชุณุชุซูู ูุณุงุฑ ุชุญุฏู ACME ูู ุฅุนุงุฏุฉ ุงูุชูุฌููุ ููุง ูุณูุญ ูู Let's Encrypt ุจุงูุชุญูู ูู ูุทุงูู ุนุจุฑ HTTP ุญุชู ุจุนุฏ ุฅุนุฏุงุฏ HTTPS." },
                    { lines: "11-13", explanation: "ุฃู ุทูุจ ุขุฎุฑ ุฅูู ุงููููุฐ 80 ูุชู ุนูู ุงูููุฑ ุฅุนุงุฏุฉ ุชูุฌููู ุจุดูู ุฏุงุฆู (301) ุฅูู ููุณ ุนููุงู URL ูููู ุจุงุณุชุฎุฏุงู ูุฎุทุท `https`. `$host` ูู ูุชุบูุฑ Nginx ูุญุชูู ุนูู ุงุณู ุงููุถูู ุงูุฐู ุทูุจู ุงููุณุชุฎุฏู." }
                ]},
                { type: ContentType.HEADING4, text: "ูุชูุฉ ุงูุฎุงุฏู ุงูุซุงููุฉ: ุชูููู SSL/TLS ุงููุนูู" },
                { type: ContentType.CODE_EXPLANATION, language: "nginx", codeTitle: "ูุชูุฉ HTTPS", code: `server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name your_domain.com www.your_domain.com;

    ssl_certificate /etc/letsencrypt/live/your_domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your_domain.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # ... The rest of your configuration (root, location, proxy_pass, etc.)
    # now lives inside this block.
}`, explanations: [
                    { lines: "2-3", explanation: "`listen 443 ssl`: ูุฎุจุฑ Nginx ุจุงูุงุณุชูุงุน ุนูู ุงููููุฐ 443 (ุงููููุฐ ุงูููุงุณู ูู HTTPS) ูุชูุนูู SSL/TLS. `http2` ูููู ุจุชูููู ุจุฑูุชูููู HTTP/2ุ ููู ุฃุณุฑุน ูุฃูุซุฑ ููุงุกุฉ." },
                    { lines: "6-7", explanation: "ูุฐู ูู ุงูุชูุฌููุงุช ุงูุชู ุชุดูุฑ ุฅูู ุดูุงุฏุชู ูููุชุงุญู ุงูุฎุงุต. ูุงุญุธ ุฃู ุงููุณุงุฑ ูุดูุฑ ุฅูู `live`ุ ููู ุฏููู ูุญุชูู ุนูู ุฑูุงุจุท ุฑูุฒูุฉ ุฅูู ุฃุญุฏุซ ูููุงุช ุงูุดูุงุฏุงุช ุงููุนููุฉ. ูุฐุง ูุณูุญ ุจุงูุชุฌุฏูุฏ ุงูุณูุณ ุฏูู ุชุบููุฑ ูุฐุง ุงูุชูููู." },
                    { lines: "8", explanation: "ูููู Certbot ุจุฅูุดุงุก ูุฐุง ุงูููู ุงูุฐู ูุญุชูู ุนูู ุฅุนุฏุงุฏุงุช ุฃูุงู TLS ููุตู ุจูุง (ูุซู ุงูุฃุตูุงุฑ ุงููููุฉ ูุงูุจุฑูุชููููุงุช ุงูุขููุฉ). ุงุณุชุฎุฏุงู `include` ููุง ูุจูู ุชููููู ุงูุฑุฆูุณู ูุธูููุง." },
                    { lines: "9", explanation: "`ssl_dhparam` ูุดูุฑ ุฅูู ููู ููุนููุงุช Diffie-Hellmanุ ููู ุถุฑูุฑู ูุชูููู ุงูุณุฑูุฉ ุงูุฃูุงููุฉ ุงูุชุงูุฉ (Perfect Forward Secrecy)." }
                ]},
              ]
            },
            {
              id: "p4_c1_s4",
              icon: "๐",
              title: "ุงููุณุชูู 78: ูุดู ุฎุจุงูุง ุฃุชูุชุฉ ุชุฌุฏูุฏ ุงูุดูุงุฏุงุช",
              content: [
                { type: ContentType.PARAGRAPH, text: "ุดูุงุฏุงุช Let's Encrypt ุตุงูุญุฉ ููุฏุฉ 90 ููููุง ููุท. ูุฐุง ุงูุชุตููู ุงููุชุนูุฏ ูุดุฌุน ุนูู ุงูุฃุชูุชุฉ ููููู ูู ุงูุถุฑุฑ ุงููุงุฌู ุนู ุงุฎุชุฑุงู ุงูููุงุชูุญ. ูููู Certbot ุจุฅุนุฏุงุฏ ูุฐู ุงูุฃุชูุชุฉ ูู." },
                { type: ContentType.HEADING4, text: "ูุคูุช Systemd: ุงูุญุงุฑุณ ุงูุตุงูุช" },
                { type: ContentType.PARAGRAPH, text: "ุนูุฏูุง ุชููู ุจุชุซุจูุช ุญุฒูุฉ Certbotุ ูุฅููุง ุชูุดุฆ ูุชูุนู ูุคูุช `systemd`. ููููู ุฑุคูุชู ุจุงุณุชุฎุฏุงู:" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo systemctl list-timers` },
                { type: ContentType.PARAGRAPH, text: "ุงุจุญุซ ุนู ุณุทุฑ ูุญุชูู ุนูู `snap.certbot.renew.timer`. ูุฐุง ุงููุคูุช ูููู ุจุชุดุบูู `certbot renew` ูุฑุชูู ูููููุง. ูุฐุง ุงูุฃูุฑ ุฐูู:" },
                { type: ContentType.LIST_UNORDERED, items: [
                    "ููุญุต ุฌููุน ุงูุดูุงุฏุงุช ุงููุซุจุชุฉ ุนูู ุงูุฎุงุฏู.",
                    "ูุชุญูู ูู ุชุงุฑูุฎ ุงูุชูุงุก ุตูุงุญูุฉ ูู ุดูุงุฏุฉ.",
                    "ุฅุฐุง ูุงูุช ุงูุดูุงุฏุฉ ุณุชูุชูู ูู ุบุถูู 30 ููููุงุ ูุฅูู ุณูุญุงูู ุชุฌุฏูุฏูุง.",
                    "ุฅุฐุง ูู ุชูู ุงูุดูุงุฏุฉ ูุฑูุจุฉ ูู ุงูุชูุงุก ุงูุตูุงุญูุฉุ ูุฅูู ูุง ููุนู ุดูุฆูุง ููุฎุฑุฌ ุจุตูุช."
                ]},
                { type: ContentType.HEADING4, text: "ูุฑุดุฉ ุนูู: ุฅุฌุฑุงุก 'ุชุดุบูู ุฌุงู' ูุงูุชุญูู ูู ุงูุฎุทุงูุงุช" },
                { type: ContentType.PARAGRAPH, text: "ููููู ูุญุงูุงุฉ ุนูููุฉ ุงูุชุฌุฏูุฏ ููุชุฃูุฏ ูู ุฃููุง ุณุชุนูู ุนูุฏูุง ูุญูู ุงูููุช." },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo certbot renew --dry-run` },
                { type: ContentType.PARAGRAPH, text: "ุฅุฐุง ุงูุชูู ูุฐุง ุงูุฃูุฑ ุจูุฌุงุญุ ูุฃูุช ุฌุงูุฒ. ุฌุฒุก ููู ูู ูุฐุง ุงููุฌุงุญ ูู 'ุฎุทุงูุงุช ุงููุดุฑ' (deploy hooks). ูููู Certbot ุชููุงุฆููุง ุจูุถุน ูุต ุจุฑูุฌู ูู `/etc/letsencrypt/renewal-hooks/deploy/`. ูุฐุง ุงููุต ุงูุจุฑูุฌู ูุชู ุชุดุบููู *ููุท* ุจุนุฏ ุชุฌุฏูุฏ ูุงุฌุญ. ุจุงููุณุจุฉ ููููู Nginx ุงูุฅุถุงููุ ูุฐุง ุงููุต ุงูุจุฑูุฌู ูููู ุจุชุดุบูู `sudo systemctl reload nginx`ุ ููุง ูุถูู ุฃู Nginx ูุจุฏุฃ ูู ุงุณุชุฎุฏุงู ุงูุดูุงุฏุฉ ุงูุฌุฏูุฏุฉ ุฏูู ุฃู ุชููู ูู ุงูุฎุฏูุฉ." },
                { type: ContentType.NOTE, title: "ุงูุชุญูู ูู ุณุฌูุงุช ุงููุคูุช", text: "ุฅุฐุง ููุช ุชุฑูุฏ ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุคูุช ูุฏ ุชู ุชุดุบููู ุจูุฌุงุญุ ููููู ูุญุต ุณุฌูุงุช systemd ุงูุฎุงุตุฉ ุจู: `sudo journalctl -u snap.certbot.renew.service`." },
              ]
            },
            {
              id: "p4_c1_s5",
              icon: "โจ",
              title: "ุงููุณุชูู 79: ูุฑุดุฉ ุนูู: ุชุญููู ุฏุฑุฌุฉ A+ ุนูู SSL Labs",
              content: [
                { type: ContentType.PARAGRAPH, text: "SSL Labs' SSL Test ูู ุงูุฃุฏุงุฉ ุงูููุงุณูุฉ ูุชุญููู ููุฉ ุชูููู TLS ุงูุฎุงุต ุจู. ุงูุญุตูู ุนูู ุฏุฑุฌุฉ A+ ููุณ ููุท ููููุงุฎุฑุฉุ ุฅูู ูุถูู ุฃูู ุชุณุชุฎุฏู ุฃููู ุงูุจุฑูุชููููุงุช ูุงูุฃุตูุงุฑ ุงููุชุงุญุฉ. ูููุฑ Certbot ุฃุณุงุณูุง ุฌูุฏูุงุ ูููู ูููููุง ุชุญุณููู." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 1: HSTS - ุงูุฃูุงู ุงูุตุงุฑู ูููู HTTP" },
                { type: ContentType.PARAGRAPH, text: "HSTS ูู ุชุฑููุณุฉ ุฃูุงู ุชุฎุจุฑ ุงููุชุตูุญ ุจุงูุชูุงุตู ูุน ูููุนู ููุท ุนุจุฑ HTTPS. ุจุนุฏ ุงูุฒูุงุฑุฉ ุงูุฃูููุ ูู ูููู ุงููุชุตูุญ ุฃุจุฏูุง ุจุฅุฌุฑุงุก ุงุชุตุงู HTTP ุฃููู ูุฑุฉ ุฃุฎุฑูุ ููุง ูุญูู ูู ูุฌูุงุช 'ุชุฌุฑูุฏ SSL'. ุฃุถู ุงูุชุฑููุณุฉ ุงูุชุงููุฉ ุฅูู ูุชูุฉ ุงูุฎุงุฏู `https` ุงูุฎุงุตุฉ ุจู:" },
                { type: ContentType.CODE_BLOCK, language: "nginx", code: `add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;` },
                { type: ContentType.PARAGRAPH, text: "**ูุดู ุงูุฎุจุงูุง:** `max-age=31536000` ูุฎุจุฑ ุงููุชุตูุญ ุจุชุฐูุฑ ูุฐู ุงููุงุนุฏุฉ ููุฏุฉ ุนุงู ูุงุญุฏ. `includeSubDomains` ูุทุจู ุงููุงุนุฏุฉ ุนูู ุฌููุน ุงููุทุงูุงุช ุงููุฑุนูุฉ. `preload` ูู ุงูุฎุทูุฉ ุงูุฅุถุงููุฉ. ุจูุฌุฑุฏ ุฃู ุชููู ูุงุซููุง ูู ุชูููููุ ููููู ุฅุฑุณุงู ูุทุงูู ุฅูู [hstspreload.org](https://hstspreload.org/). ุณูุคุฏู ูุฐุง ุฅูู ุชุถููู ูุทุงูู ูุจุงุดุฑุฉ ูู ููุฏ ุงููุตุฏุฑ ูููุชุตูุญุงุช ุงูุฑุฆูุณูุฉุ ููุง ูุนูู ุฃููุง ูู ุชุญุงูู ุฃุจุฏูุง ุฅุฌุฑุงุก ุงุชุตุงู HTTP ุฃูููุ ุญุชู ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ูุฒูุฑ ูููุง ุงููุณุชุฎุฏู ูููุนู." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ุชุฏุจูุณ OCSP (OCSP Stapling)" },
                { type: ContentType.PARAGRAPH, text: "ูุฐุง ุชุญุณูู ููุฃุฏุงุก. ูููู ุฎุงุฏูู ุจุงูุชุญูู ุจุดูู ุฏูุฑู ูู ุญุงูุฉ ุฅูุบุงุก ุดูุงุฏุชู ู 'ูุฏุจุณ' ุงูุงุณุชุฌุงุจุฉ ุนูู ุดูุงุฏุชูุ ููุง ูููุฑ ุนูู ูุชุตูุญ ุงููุณุชุฎุฏู ุฑุญูุฉ ุฐูุงุจ ูุนูุฏุฉ. ูุชู ุชูููู ูุฐุง ุนุงุฏุฉู ูู ููู `options-ssl-nginx.conf` ุงูุฐู ุฃูุดุฃู Certbot. ุชุฃูุฏ ูู ุฃู ูุฐู ุงูุฃุณุทุฑ ููุฌูุฏุฉ ูุบูุฑ ูุนููุฉ:" },
                { type: ContentType.CODE_BLOCK, language: "nginx", code: `ssl_stapling on;
ssl_stapling_verify on;
# You also need to specify a trusted resolver for OCSP lookups
resolver 8.8.8.8 8.8.4.4 valid=300s;` },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 3: ูุฌููุนุงุช ุงูุชุดููุฑ ุงููููุฉ (Strong Cipher Suites)" },
                { type: ContentType.PARAGRAPH, text: "ูุฌุจ ุนููู ุชูููุฏ ุฎุงุฏูู ููุจูู ูุฌููุนุงุช ุงูุชุดููุฑ ุงูุญุฏูุซุฉ ูุงููููุฉ ููุท ุงูุชู ุชุฏุนู ุงูุณุฑูุฉ ุงูุฃูุงููุฉ ุงูุชุงูุฉ (Perfect Forward Secrecy). ูุฑุฉ ุฃุฎุฑูุ ูููุฑ Certbot ูุงุฆูุฉ ุฌูุฏุฉ ูู `options-ssl-nginx.conf`. ููููู ุงุณุชุฎุฏุงู 'ูููุฏ ุชูููู SSL' ูู Mozilla ููุญุตูู ุนูู ุฃุญุฏุซ ุงูุชูุตูุงุช. ุชุฃูุฏ ูู ุฃู ุชูููู `ssl_ciphers` ุงูุฎุงุต ุจู ูุนุทู ุงูุฃููููุฉ ูุฃุตูุงุฑ `ECDHE` ู `TLS_AES_256_GCM_SHA384`." },
                { type: ContentType.NOTE, title: "ุงูุงุฎุชุจุงุฑุ ุงูุงุฎุชุจุงุฑุ ุงูุงุฎุชุจุงุฑ", text: "ุจุนุฏ ุฅุฌุฑุงุก ูุฐู ุงูุชุบููุฑุงุชุ ุฃุนุฏ ุชุดุบูู Nginx (`sudo systemctl restart nginx`) ูุฃุนุฏ ุชุดุบูู ุงุฎุชุจุงุฑ SSL Labs. ูุฌุจ ุฃู ุชุฑู ุงูุขู ุฏุฑุฌุฉ A+ ุงููุงูุนุฉ. ููุฏ ููุช ุจุชุญููู ุฎุงุฏูู ูู 'ุขูู' ุฅูู 'ูุญุตู'." },
              ]
            }
        ]
    },
     {
        id: "p4_c2", chapterTitle: "ุงููุตู ุงูุณุงุจุน ุนุดุฑ: ุฃูุธูุฉ ูุดู ุงูุชุณูู ูุงูุญูุงูุฉ",
        sections: [
            {
              id: "p4_c2_s1",
              icon: "๐",
              title: "ุงููุณุชูู 80: ูุฑุดุฉ ุนูู Fail2Ban: ุฅูุดุงุก ูุฑุดุญ ูุณุฌู ูุฎุตุต",
              content: [
                { type: ContentType.PARAGRAPH, text: "ููุฉ Fail2Ban ุงูุญููููุฉ ูู ูุฏุฑุชู ุนูู ูุฑุงูุจุฉ ุฃู ููู ุณุฌู ูุฃู ุชุทุจูู. **ุงูุณููุงุฑูู:** ูุฏููุง ุชุทุจูู Node.js/Express ูุณุฌู ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ุงููุงุดูุฉ ุฅูู `/var/log/my-app.log` ุจุงูุชูุณูู ุงูุชุงูู:" },
                { type: ContentType.PREFORMATTED_TEXT, text: `[2023-10-26T10:30:00Z] ERROR: Login failed for user 'admin' from IP 1.2.3.4` },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 1: ุฅูุดุงุก ูุฑุดุญ ูุฎุตุต (Filter)" },
                { type: ContentType.PARAGRAPH, text: "ุงููุฑุดุญ ูุฎุจุฑ Fail2Ban ุจููููุฉ ุงูุนุซูุฑ ุนูู ุนูุงููู IP ุงูุถุงุฑุฉ ูู ุงูุณุฌู. ุณููุดุฆ ููููุง ุฌุฏูุฏูุง:" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: "sudo nano /etc/fail2ban/filter.d/my-app-auth.conf" },
                { type: ContentType.CODE_EXPLANATION, language: "ini", codeTitle: "my-app-auth.conf", code: `[Definition]
failregex = ^.*ERROR: Login failed for user '.*' from IP <HOST>$
ignoreregex =`, explanations: [
                    { lines: "2", explanation: "`failregex` ูู ุชุนุจูุฑ ููุทู (regex). `<HOST>` ูู ุนูุตุฑ ูุงุฆุจ ุฎุงุต ุจู Fail2Ban ููุชูุท ุนููุงู IP ุงููุทุงุจู. ูุฐุง ุงูุชุนุจูุฑ ุงูููุทู ูุทุงุจู ุจุงูุถุจุท ุชูุณูู ุณุทุฑ ุงูุณุฌู ุงูุฎุงุต ุจูุง." }
                ]},
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ุฅูุดุงุก ุณุฌู ูุฎุตุต (Jail)" },
                { type: ContentType.PARAGRAPH, text: "ุงูุณุฌู ูุฑุจุท ุงููุฑุดุญ ุจููู ุณุฌู ูุฅุฌุฑุงุก. ูุง ุชุนุฏู `jail.conf` ูุจุงุดุฑุฉ. ุจุฏูุงู ูู ุฐููุ ูู ุจุฅูุดุงุก ููู `.local` ููุชุฌุงูุฒุงุช." },
                { type: ContentType.CODE_BLOCK, language: "bash", code: "sudo nano /etc/fail2ban/jail.d/my-app.local" },
                { type: ContentType.CODE_EXPLANATION, language: "ini", codeTitle: "my-app.local", code: `[my-app-auth]
enabled = true
port = http,https
filter = my-app-auth
logpath = /var/log/my-app.log
maxretry = 5
bantime = 1h
findtime = 10m`, explanations: [
                    { lines: "1", explanation: "ุงุณู ุงูุณุฌู. ูุฌุจ ุฃู ูููู ูุฑูุฏูุง." },
                    { lines: "2-7", explanation: "ูููู ูู Fail2Ban ุฃู ูุฐุง ุงูุณุฌู ูููููุ ููุฌุจ ุฃู ูุญุธุฑ ุญุฑูุฉ ุงููุฑูุฑ ุนูู ููุงูุฐ ุงูููุจุ ููุณุชุฎุฏู ุงููุฑุดุญ ุงูุฐู ุฃูุดุฃูุงูุ ููุฑุงูุจ ููู ุงูุณุฌู ุงูุตุญูุญ. `maxretry = 5`, `findtime = 10m`, `bantime = 1h` ุชุนูู: 'ุฅุฐุง ุฑุฃูุช 5 ูุญุงููุงุช ูุงุดูุฉ ูู ููุณ IP ูู ุบุถูู 10 ุฏูุงุฆูุ ููู ุจุญุธุฑู ููุฏุฉ ุณุงุนุฉ'." },
                  ] },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 3: ุฃุนุฏ ุงูุชุดุบูู ูุงุฎุชุจุฑ" },
                { type: ContentType.PARAGRAPH, text: "ุฃุนุฏ ุชุดุบูู Fail2Ban (`sudo systemctl restart fail2ban`). ููููู ุงุฎุชุจุงุฑ ุงูุชุนุจูุฑ ุงูููุทู ุงูุฎุงุต ุจู ุจุงุณุชุฎุฏุงู: `fail2ban-regex /var/log/my-app.log /etc/fail2ban/filter.d/my-app-auth.conf`. ูุฌุจ ุฃู ูุธูุฑ ูู ุนุฏุฏ ุงููุทุงุจูุงุช. ููุฏ ููุช ุงูุขู ุจุชูุณูุน Fail2Ban ูุญูุงูุฉ ุชุทุจููู ุงููุฎุตุต." },
              ]
            },
            {
                id: "p4_c2_s2",
                icon: "๐",
                title: "ุงููุณุชูู 81: ุฅุนุฏุงุฏ ุชูุจููุงุช Fail2Ban ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ุงูุญุธุฑ ุงูุชููุงุฆู ุฑุงุฆุนุ ูููู ูู ุงููููุฏ ุฃูุถูุง ุฃู ุชุนุฑู ูุชู ูุชู ุญุธุฑ ุดุฎุต ูุง. ูููู ูู Fail2Ban ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ููุตู ูู ูู ูุฑุฉ ูุชุฎุฐ ูููุง ุฅุฌุฑุงุกู. ูุชุทูุจ ูุฐุง ุฅุนุฏุงุฏ ูููู ููู ุงูุจุฑูุฏ (MTA) ูุซู `postfix` ุนูู ุฎุงุฏูู." },
                  { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 1: ุชุซุจูุช ูุชูููู Postfix" },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo apt update
sudo apt install postfix mailutils -y`},
                  { type: ContentType.PARAGRAPH, text: "ุฃุซูุงุก ุงูุชุซุจูุชุ ุงุฎุชุฑ 'Internet Site'. ุงุถุจุท 'system mail name' ุนูู ูุทุงูู. ุจุนุฏ ุฐููุ ุณุชุญุชุงุฌ ุฅูู ุชูููู Postfix ูุฅุนุงุฏุฉ ุชูุฌูู ุงูุจุฑูุฏ ุนุจุฑ ูุฒูุฏ ุจุฑูุฏ ุฅููุชุฑููู ุญูููู (ูุซู SendGrid ุฃู Mailgun) ูุชุฌูุจ ูุถุน ุนูุงูุฉ ุนูู ุฑุณุงุฆูู ูุจุฑูุฏ ุนุดูุงุฆู. ูุชุถูู ูุฐุง ุชุนุฏูู `/etc/postfix/main.cf` ูุชูููู ูุตุงุฏูุฉ SMTP." },
                  { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ุชูููู ุฅุฌุฑุงุก ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูู Fail2Ban" },
                  { type: ContentType.PARAGRAPH, text: "ูู ููู `/etc/fail2ban/jail.d/my-app.local`ุ ูู ุจุชุนุฏูู ุณุฌูู ููุดูู ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:" },
                  { type: ContentType.CODE_EXPLANATION, language: "ini", codeTitle: "ุชุญุฏูุซ my-app.local", code: `[my-app-auth]
# ... (enabled, port, filter, logpath, etc.) ...
destemail = your.email@example.com
sender = fail2ban@your_domain.com
action = %(action_mwl)s`, explanations: [
                      { lines: "3", explanation: "`destemail` ูู ุนููุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงูุฐู ุณูุชููู ุงูุชูุจููุงุช." },
                      { lines: "4", explanation: "`sender` ูู ุนููุงู 'ูู'." },
                      { lines: "5", explanation: "`action` ูู ุฃูู ุฌุฒุก. `%(action_mwl)s` ูู ุงุฎุชุตุงุฑ ูุฅุฌุฑุงุก ูุฏูุฌ ูุนูู: 'ูู ุจุงูุญุธุฑ ูุฃุฑุณู ุจุฑูุฏูุง ุฅููุชุฑููููุง ูุญุชูู ุนูู ุชูุฑูุฑ `whois` ูุณุทูุฑ ุงูุณุฌู ุฐุงุช ุงูุตูุฉ'. ููุงู ุฅุฌุฑุงุกุงุช ุฃุฎุฑู ูุซู `%(action_m)s` (ุจุฑูุฏ ุฅููุชุฑููู ููุท) ุฃู `%(action_mw)s` (ุจุฑูุฏ ุฅููุชุฑููู + whois)." }
                  ] },
                  { type: ContentType.PARAGRAPH, text: "ุฃุนุฏ ุชุดุบูู Fail2Ban. ุงูุขูุ ูู ุงููุฑุฉ ุงูุชุงููุฉ ุงูุชู ูุชู ูููุง ุชุดุบูู ูุฐุง ุงูุณุฌูุ ุณุชุชููู ุจุฑูุฏูุง ุฅููุชุฑููููุง ูุญุชูู ุนูู ุชูุงุตูู ูุงููุฉ ุนู ุงูููุงุฌูุ ููุง ูููุญู ุฑุคูุฉ ููุฑูุฉ ููุชูุฏูุฏุงุช ุถุฏ ุชุทุจููู." },
                ]
            },
            {
                id: "p4_c2_s3",
                icon: "๐๏ธ",
                title: "ุงููุณุชูู 82: ููุฏูุฉ ุฅูู HIDS ูุฏุฑุงุณุฉ ุญุงูุฉ Wazuh",
                content: [
                  { type: ContentType.PARAGRAPH, text: "Fail2Ban ููุชุงุฒ ููุฑุงูุจุฉ ุงูุณุฌูุงุชุ ูููู ูุง ูุฑู ูุง ูุญุฏุซ ูู ุจููุฉ ุงููุธุงู. ูุธุงู ูุดู ุงูุชุณูู ุงููุณุชูุฏ ุฅูู ุงููุถูู (HIDS) ููุนู ุฐูู. Wazuh ูู HIDS ููุชูุญ ุงููุตุฏุฑ ูุฑุงุฆุฏ. ุฅูู ูุนูู ูู ุฎูุงู ูููุฐุฌ ูููู/ุฎุงุฏู: ุชููู ุจุชุซุจูุช ูููู (agent) ุฎููู ุงููุฒู ุนูู ูู ุฎุงุฏู ุชุฑูุฏ ูุฑุงูุจุชูุ ููููู ูุฐุง ุงููููู ุจุฌูุน ุงูุจูุงูุงุช ูุฅุฑุณุงููุง ุฅูู ุฎุงุฏู Wazuh ูุฑูุฒู ููุชุญููู." },
                  { type: ContentType.HEADING4, text: "ูุง ุงูุฐู ูุฑุงูุจู ูููู Wazuhุ" },
                  { type: ContentType.LIST_UNORDERED, items: [
                      "<strong>ุณูุงูุฉ ุงููููุงุช (File Integrity Monitoring - FIM):</strong> ูุฑุงูุจ ุงูุชุบููุฑุงุช (ุงูุฅูุดุงุกุ ุงูุชุนุฏููุ ุงูุญุฐู) ูู ุงููููุงุช ูุงูุฏูุงุฆู ุงูุญูููุฉ. ูุฐุง ูู ุฌููุฑ HIDS.",
                      "<strong>ูุดู ุฃุฏูุงุช ุงูุงุฎุชุฑุงู (Rootkit Detection):</strong> ูุจุญุซ ุนู ุนูุงูุงุช ุฃุฏูุงุช ุงูุงุฎุชุฑุงู ุงูุดุงุฆุนุฉ.",
                      "<strong>ุณุฌูุงุช ุงููุธุงู ูุงูุชุทุจููุงุช:</strong> ูุฌูุน ุงูุณุฌูุงุช ูู ูุตุงุฏุฑ ูุชุนุฏุฏุฉุ ููููู ุจุชุทุจูุนูุงุ ูุชุญููููุง ุจุญุซูุง ุนู ูุคุดุฑุงุช ุงููุฌูู.",
                      "<strong>ุชูููู ุงูุฃูุงู:</strong> ูุชุญูู ุจุดูู ุฏูุฑู ูู ุชูููู ุงููุธุงู ููุงุจู ูุนุงููุฑ ุงูุฃูุงู (ูุซู CIS Benchmarks).",
                      "<strong>ูุดุงุท ุงูุดุจูุฉ ูุงูุนูููุงุช:</strong> ูุฑุงูุจ ุงูุนูููุงุช ุงูุฌุฏูุฏุฉ ูุงูุงุชุตุงูุงุช ุงูุดุจููุฉ ุงููุดุจููุฉ."
                  ] },
                  { type: ContentType.HEADING4, text: "ุฏุฑุงุณุฉ ุญุงูุฉ: ุงููุจุถ ุนูู ูุชุณูู ูุชูุจุณูุง" },
                  { type: ContentType.PARAGRAPH, text: "**ุงูุณููุงุฑูู:** ุชููู ููุงุฌู ูู ุงููุตูู ุฅูู ุฎุงุฏูู. ูุฅุฎูุงุก ุขุซุงุฑูุ ูุญุงูู ุงุณุชุจุฏุงู ุงูุฃูุฑ `/bin/ls` ุจุฅุตุฏุงุฑ ูุนุฏู ูุฎูู ูููุงุชู ูุนูููุงุชู. ููุฑู ููู ููุชุดู Wazuh ูุฐุง." },
                  { type: ContentType.PARAGRAPH, text: "ุนูุฏูุง ูุชู ุชุซุจูุช ูููู Wazuhุ ูุฅูู ูููู ุจูุณุญ ุฃููู ูููููุงุช ุงูุญูููุฉ ูู ุงููุธุงู (ูู `/bin`, `/sbin`, `/etc`ุ ุฅูุฎ). ูููู ุจุญุณุงุจ ุงููุฌููุน ุงูุงุฎุชุจุงุฑู (checksum) ููู ููู (ูุซู SHA256) ููุฎุฒู ูุฐู 'ุงูุญุงูุฉ ุงูุฐูุจูุฉ' ูู ูุงุนุฏุฉ ุจูุงูุงุชู. ูููู ุงููููู ุจุนุฏ ุฐูู ุจุฅุนุงุฏุฉ ูุญุต ูุฐู ุงูุฏูุงุฆู ุจุดูู ุฏูุฑู. ุนูุฏูุง ูููู ุงูููุงุฌู ุจุงุณุชุจุฏุงู `/bin/ls`ุ ุณููุงุญุธ Wazuh ูู ุงููุญุต ุงูุชุงูู ุฃู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ููููู ูุฏ ุชุบูุฑ." },
                  { type: ContentType.PARAGRAPH, text: "ุณูููู ุงููููู ุนูู ุงูููุฑ ุจุฅุฑุณุงู ุชูุจูู ุฅูู ูุฏูุฑ Wazuhุ ูุงูุฐู ุณูุธูุฑ ูู ููุญุฉ ุงูุชุญูู (Kibana). ุณูุจุฏู ุงูุชูุจูู ุดูุฆูุง ููุฐุง:" },
                  { type: ContentType.PREFORMATTED_TEXT, text: `**Rule: 550 - Integrity checksum changed.**
**Level:** 7 (High importance)
**Location:** web-server-1
**File:** /bin/ls
**Description:** Integrity checksum changed for '/bin/ls'.
**Old Checksum:** sha256:abc...
**New Checksum:** sha256:xyz...` },
                  { type: ContentType.PARAGRAPH, text: "ูุฐุง ุงูุชูุจูู ูู ุฏููู ูุงุทุน ุนูู ูุฌูุฏ ุชุณููุฉ. ูุฎุจุฑู ุจุงูุถุจุท ุจุงูููู ุงูุฐู ุชู ุชุบููุฑูุ ููุชูุ ูููู. ุจุฏูู HIDSุ ูุฏ ุชูุฑ ูุฐู ุงูุฃููุงุน ูู ุงูุชุนุฏููุงุช ุงูุฎููุฉ ุฏูู ุฃู ููุงุญุธูุง ุฃุญุฏ ูุฃุณุงุจูุน ุฃู ุฃุดูุฑ." },
                ]
            },
            {
                id: "p4_c2_s4",
                icon: "๐ฆ",
                title: "ุงููุณุชูู 83: ุชุซุจูุช ูุชูููู ูููู Wazuh",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ูุชุทูุจ Wazuh ุฎุงุฏููุง ูุฑูุฒููุงุ ูุงูุฐู ุบุงูุจูุง ูุง ูุชู ุชุซุจูุชู ุจุงุณุชุฎุฏุงู Docker ุฃู ูุญุฒูุฉ. ุจูุฌุฑุฏ ุชุดุบูู ุงูุฎุงุฏูุ ูุฅู ุฅุถุงูุฉ ูููู ุฃูุฑ ุจุณูุท. ุณููุชุฑุถ ุฃู ุฎุงุฏู Wazuh ุงูุฎุงุต ุจู ููุฌูุฏ ุนูู `10.0.0.5`." },
                  { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 1: ุชุณุฌูู ุงููููู (ุนูู ุฎุงุฏู Wazuh)" },
                  { type: ContentType.PARAGRAPH, text: "ุชุญุชุงุฌ ุฅูู ุชุณุฌูู ูู ูููู ุฌุฏูุฏ ูุงูุญุตูู ุนูู ููุชุงุญ ูุตุงุฏูุฉ ูุฑูุฏ ูู." },
                  { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ุชุซุจูุช ุงููููู (ุนูู ุฎุงุฏู ุงูููุจ ุงูุฎุงุต ุจู)" },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `curl -so wazuh-agent.deb https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.5.2-1_amd64.deb
sudo WAZUH_MANAGER='10.0.0.5' WAZUH_AGENT_NAME='web-server-01' dpkg -i ./wazuh-agent.deb` },
                  { type: ContentType.PARAGRAPH, text: "ูููู ุจุชูุฑูุฑ ุนููุงู IP ููุฎุงุฏู ูุงุณู ูุฑูุฏ ูููููู ููุชุบูุฑุงุช ุจูุฆุฉ ุฃุซูุงุก ุงูุชุซุจูุช." },
                  { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 3: ุงุณุชูุฑุงุฏ ุงูููุชุงุญ ูุจุฏุก ุงูุชุดุบูู" },
                  { type: ContentType.PARAGRAPH, text: "ุฃูุช ุงูุขู ุจุญุงุฌุฉ ุฅูู ุงุณุชูุฑุงุฏ ุงูููุชุงุญ ุงูุฐู ุชู ุฅูุดุงุคู ูู ุงูุฎุทูุฉ 1." },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo /var/ossec/bin/manage_agents -i <KEY_FROM_STEP_1>
sudo systemctl daemon-reload
sudo systemctl enable wazuh-agent
sudo systemctl start wazuh-agent` },
                  { type: ContentType.PARAGRAPH, text: "ุณูููู ุงููููู ุงูุขู ุจุงูุงุชุตุงู ุจุงูุฎุงุฏูุ ูุชูุฒูู ุชููููู ุงููุฑูุฒูุ ูุงูุจุฏุก ูู ูุฑุงูุจุฉ ูุธุงูู." },
                ]
            },
            {
                id: "p4_c2_s5",
                icon: "๐ก๏ธ",
                title: "ุงููุณุชูู 84: ูุฑุดุฉ ุนูู ModSecurity: ุญุธุฑ ูุฌูู ุญูู SQL",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ุฌุฏุงุฑ ุญูุงูุฉ ุชุทุจููุงุช ุงูููุจ (WAF) ูุซู ModSecurity ููุญุต ุญุฑูุฉ ูุฑูุฑ HTTP ุงููุนููุฉ ุจุญุซูุง ุนู ุฃููุงุท ุงููุฌูู. ุฅูู ูุนูู ููุฑุดุญ ุจูู ุงูุฅูุชุฑูุช ู Nginx. **ุงูุณููุงุฑูู:** ูุญุงูู ููุงุฌู ุงุณุชุบูุงู ุซุบุฑุฉ ุญูู SQL ูู ูุนููุฉ URL." },
                  { type: ContentType.PARAGRAPH, text: "ุงูุทูุจ ุงูุถุงุฑ:" },
                  { type: ContentType.PREFORMATTED_TEXT, text: `GET /products?id=123' OR 1=1; --` },
                  { type: ContentType.HEADING4, text: "ุขููุฉ ุงููุดู: ูุฌููุนุฉ ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ ูู OWASP (CRS)" },
                  { type: ContentType.PARAGRAPH, text: "ุจุนุฏ ุชุซุจูุช ModSecurity ู CRSุ ููุฑ ูู ุทูุจ ุนุจุฑ ูุญุฑู ุงูููุงุนุฏ. ุฅุญุฏู ุงูููุงุนุฏ ูู CRS (ุนูู ูุฌู ุงูุชุญุฏูุฏ ุงููุงุนุฏุฉ 942100) ูุตููุฉ ููุจุญุซ ุนู ุฃููุงุท ุญูู SQL ุงูุดุงุฆุนุฉ. ุนูุฏูุง ูุฑู ModSecurity ูุฐุง ุงูุทูุจุ ุณูุญุฏุซ ูุง ููู:" },
                  { type: ContentType.LIST_UNORDERED, items: [
                      "ูุทุงุจู ุงูุฌุฒุก `' OR 1=1` ูุน ููุท ูุนุฑูู ูู ุงููุงุนุฏุฉ 942100.",
                      "ูุฒูุฏ 'ุฏุฑุฌุฉ ุงูุดุฐูุฐ' (anomaly score) ููุทูุจ.",
                      "ูุธุฑูุง ูุฃู ุญูู SQL ุฎุทูุฑุ ูุฅู ูุฐู ุงููุงุนุฏุฉ ุงููุงุญุฏุฉ ุณุชุฒูุฏ ุงูุฏุฑุฌุฉ ุจูุง ูููู ูุชุฌุงูุฒ ุงูุญุฏ ุงูุงูุชุฑุงุถู.",
                      "ุณูููู ModSecurity ุจุญุธุฑ ุงูุทูุจ ูุฅุฑุฌุงุน ุงุณุชุฌุงุจุฉ `403 Forbidden` ุฅูู ุงูููุงุฌู.",
                      "ุณูุชู ุชุณุฌูู ุงููุฌูู ูู ุณุฌู ุชุฏููู ModSecurity (`/var/log/modsec_audit.log`)."
                  ] },
                  { type: ContentType.HEADING4, text: "ุณุฌู ุงูุชุฏููู" },
                  { type: ContentType.PARAGRAPH, text: "ุณูุญุชูู ุงูุณุฌู ุนูู ุชูุงุตูู ูุงููุฉ ุนู ุงููุฌูู:" },
                  { type: ContentType.PREFORMATTED_TEXT, text: `---b8a7b3e8---
[26/Oct/2023:11:00:00 +0000] ...
Request: GET /products?id=123' OR 1=1; --
...
Message: SQL Injection Attack Detected via libinjection
...
Action: Intercepted (phase 2)
...` },
                  { type: ContentType.NOTE, title: "ุงูุฅูุฌุงุจูุงุช ุงููุงุฐุจุฉ (False Positives)", text: "ุฃูุจุฑ ุชุญุฏู ูุน WAFs ูู ุงูุฅูุฌุงุจูุงุช ุงููุงุฐุจุฉุ ุญูุซ ูุชู ุญุธุฑ ุงูุทูุจุงุช ุงูุดุฑุนูุฉ ุนู ุทุฑูู ุงูุฎุทุฃ. ูุชุทูุจ ุถุจุท ModSecurity ู CRS ููุชูุง ูุฎุจุฑุฉ. ุงุจุฏุฃ ุฏุงุฆููุง ูู ูุถุน ุงููุดู ููุท (`SecRuleEngine DetectionOnly`) ููู ุจุชุญููู ุงูุณุฌูุงุช ูุจู ุงูุชุจุฏูู ุฅูู ูุถุน ุงูุญุธุฑ (`SecRuleEngine On`)." },
                ]
            }
        ]
    },
     {
        id: "p4_c3", chapterTitle: "ุงููุตู ุงูุซุงูู ุนุดุฑ: ุชุฏููู ุงููุธุงู ูุชูููุชู",
        sections: [
            {
              id: "p4_c3_s1",
              icon: "๐",
              title: "ุงููุณุชูู 85: ูุฑุดุฉ ุนูู `lynis`: ูู C ุฅูู A",
              content: [
                { type: ContentType.PARAGRAPH, text: "`lynis` ูู ุฃุฏุงุฉ ุชุฏููู ุฃูุงู ุชููู ุจูุญุต ูุธุงูู ููุงุจู ูุฆุงุช ูู ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฃูููุฉ ูุชูุฏู ุชูุตูุงุช ูุชูููุชู. **ุงูุณููุงุฑูู:** ุณูููู ุจุฅุฌุฑุงุก ูุญุต 'ูุจู ูุจุนุฏ' ุนูู ุฎุงุฏู Ubuntu ุฌุฏูุฏ." },
                { type: ContentType.HEADING4, text: "ุงููุญุต ุงูุฃูู (ูุจู)" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo apt install lynis -y
sudo lynis audit system` },
                { type: ContentType.PARAGRAPH, text: "ุจุนุฏ ุงูุชูุงู ุงููุญุตุ ูุฏ ูุนุทูู `lynis` 'ุฏุฑุฌุฉ ุชูููุฉ' ุฃูููุฉุ ูููู 65. ุณููุฏู ูุงุฆูุฉ ุทูููุฉ ูู ุงูุชุญุฐูุฑุงุช ูุงูุงูุชุฑุงุญุงุช. ููุฑูุฒ ุนูู ุงุซููู ูู ุฃูููุง:" },
                { type: ContentType.PREFORMATTED_TEXT, text: `  * Harden the system by installing at least one malware scanner. [SECURITY-5120]
  * Harden compilers by installing 'hardening-wrapper'. [HARD-8264]
  * Consider hardening SSH configuration. [SSH-7408]` },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ุงูุฅุตูุงุญ" },
                { type: ContentType.PARAGRAPH, text: "ุจูุงุกู ุนูู ุงูุงูุชุฑุงุญุงุชุ ุณูููู ุจุชูููุฐ ุงูุฅุตูุงุญุงุช:" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `# Fix 1: Install a malware scanner
sudo apt install chkrootkit -y

# Fix 2: Install hardening-wrapper
sudo apt install hardening-wrapper -y

# Fix 3: Harden SSH (add ClientAliveInterval)
echo "ClientAliveInterval 300" | sudo tee -a /etc/ssh/sshd_config
sudo systemctl restart sshd` },
                { type: ContentType.HEADING4, text: "ุงููุญุต ุงูุซุงูู (ุจุนุฏ)" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo lynis audit system` },
                { type: ContentType.PARAGRAPH, text: "ูุฐู ุงููุฑุฉุ ูุฌุจ ุฃู ุชููู ุฏุฑุฌุฉ ุงูุชูููุฉ ุฃุนูู ุจูุซูุฑ (ุนูู ุณุจูู ุงููุซุงูุ 80). ุงูุชุญุฐูุฑุงุช ุงูุชู ุนุงูุฌูุงูุง ุณุชุฎุชูู. ูุฐุง ููุถุญ ููู ูููู ุงุณุชุฎุฏุงู `lynis` ูุฎุงุฑุทุฉ ุทุฑูู ูููุฌูุฉ ูุชุญุณูู ุฃูุงู ุฎุงุฏูู." },
              ]
            },
            {
                id: "p4_c3_s2",
                icon: "๐ฆ",
                title: "ุงููุณุชูู 86: ุงุณุชุฎุฏุงู `chkrootkit` ู `rkhunter` ููุจุญุซ ุนู ุฃุฏูุงุช ุงูุงุฎุชุฑุงู",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ุฃุฏูุงุช ุงูุงุฎุชุฑุงู (Rootkits) ูู ุจุฑุงูุฌ ุถุงุฑุฉ ูุตููุฉ ูุฅุฎูุงุก ูุฌูุฏูุง ููุฌูุฏ ุจุฑุงูุฌ ุถุงุฑุฉ ุฃุฎุฑู ุนูู ุงููุธุงู. `chkrootkit` ู `rkhunter` ููุง ุฃุฏุงุชุงู ููุงุณูููุชุงู ูุณุทุฑ ุงูุฃูุงูุฑ ุชุจุญุซุงู ุนู ุนูุงูุงุช ุดุงุฆุนุฉ ููุฅุตุงุจุฉ." },
                  { type: ContentType.HEADING4, text: "ููู ุชุนููุ" },
                  { type: ContentType.PARAGRAPH, text: "ุชููู ูุฐู ุงูุฃุฏูุงุช ุจุณูุณูุฉ ูู ุงูุงุฎุชุจุงุฑุงุชุ ุจูุง ูู ุฐูู:" },
                  { type: ContentType.LIST_UNORDERED, items: [
                      "ููุงุฑูุฉ ุฎุตุงุฆุต ุงููููุงุช ุงูุซูุงุฆูุฉ ุงููุงูุฉ ูููุธุงู (ูุซู `ls`, `ps`) ุจููุณุฎ ุฌูุฏุฉ ูุนุฑููุฉ.",
                      "ุงูุจุญุซ ุนู ุชูููุนุงุช ุฃุฏูุงุช ุงูุงุฎุชุฑุงู ุงููุนุฑููุฉ ูู ุงููููุงุช.",
                      "ุงูุชุญูู ูู ูุฌูุฏ ูุงุฌูุงุช ุดุจูุฉ ูู ูุถุน promiscuous.",
                      "ูุญุต ุงููููุงุช ุงููุฎููุฉ ูู ุฏูุงุฆู ุงููุธุงู."
                  ] },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo apt install chkrootkit rkhunter -y
# ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช rkhunter
sudo rkhunter --update
# ุชุดุบูู ุงููุญูุตุงุช
sudo chkrootkit
sudo rkhunter --check` },
                  { type: ContentType.NOTE, title: "ุงูุฅูุฌุงุจูุงุช ุงููุงุฐุจุฉ ูุงููููุฏ", text: "ูููู ููุฐู ุงูุฃุฏูุงุช ุฃู ุชูุชุฌ ุฃุญูุงููุง ุฅูุฌุงุจูุงุช ูุงุฐุจุฉ. ูู ุงูููู ุงูุชุญููู ูู ุฃู ูุชุงุฆุฌ. ุนูุงูุฉ ุนูู ุฐููุ ูููู ูุฃุฏูุงุช ุงูุงุฎุชุฑุงู ุงูุญุฏูุซุฉ ุฃู ุชุชุฌูุจ ูุฐู ุงูุฃููุงุน ูู ุงููุญูุตุงุช. ููุฐุง ุงูุณุจุจุ ุชุนุฏ ุฃุฏูุงุช ูุซู Wazuh (HIDS) ุงูุชู ุชุฑุงูุจ ุณููู ุงููุธุงู ูู ุงูููุช ุงููุนูู ุฃูุซุฑ ูุนุงููุฉ ุถุฏ ุงูุชูุฏูุฏุงุช ุงููุชูุฏูุฉ." },
                ]
            },
            {
              id: "p4_c3_s3",
              icon: "๐ง",
              title: "ุงููุณุชูู 87: ูุดู ุฎุจุงูุง ุชูููุฉ ููุงุฉ ููููุณ (Kernel Hardening)",
              content: [
                { type: ContentType.PARAGRAPH, text: "ุชูููุฉ ุงูููุงุฉ ุนุจุฑ `sysctl` ูู ุฅุญุฏู ุฃูุซุฑ ุงูุทุฑู ูุนุงููุฉ ููุญูุงูุฉ ูู ุงููุฌูุงุช ุนูู ูุณุชูู ุงูุดุจูุฉ. ูู ูุชุนูู ููุท 'ูุงุฐุง' ูุบูุฑุ ูููู 'ููุงุฐุง' ูุนูู. ูุชู ุฅุฌุฑุงุก ูุฐู ุงูุชุบููุฑุงุช ูู `/etc/sysctl.conf`." },
                { type: ContentType.HEADING4, text: "ุฏุฑุงุณุฉ ุญุงูุฉ 1: ููุน ุงูุชุญุงู IP ูุน `rp_filter`" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1`},
                { type: ContentType.PARAGRAPH, text: "**ููุงุฐุง ูุนููุ** `rp_filter` (Reverse Path Filtering) ูููู ุจุฅุฌุฑุงุก ูุญุต ุจุณูุท ููููู ููู: ุนูุฏูุง ุชุตู ุญุฒูุฉ ูู ูุงุฌูุฉ ุดุจูุฉ ูุนููุฉุ ุชุชุญูู ุงูููุงุฉ ูู ุฌุฏูู ุงูุชูุฌูู ุงูุฎุงุต ุจูุง. ูู ุณุชุฑุณู ุญุฒูุฉ *ุนุงุฆุฏุฉ* ุฅูู ุนููุงู IP ุงููุตุฏุฑ ูุฐุง ุนุจุฑ ููุณ ุงููุงุฌูุฉ ุงูุชู ูุตูุช ูููุงุ ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ูุงุ ููุฐุง ูุนูู ุนูู ุงูุฃุฑุฌุญ ุฃู ุนููุงู IP ุงููุตุฏุฑ ูุฒูู (ููุชุญู)ุ ูุชููู ุงูููุงุฉ ุจุฅุณูุงุท ุงูุญุฒูุฉ. ูุฐุง ูุฎูู ูู ูุฌูุงุช DDoS ุงูุชู ุชุณุชุฎุฏู ุนูุงููู IP ููุชุญูุฉ." },
                { type: ContentType.HEADING4, text: "ุฏุฑุงุณุฉ ุญุงูุฉ 2: ุงููุฌุงุฉ ูู ููุถุงู SYN ูุน `tcp_syncookies`" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `net.ipv4.tcp_syncookies = 1`},
                { type: ContentType.PARAGRAPH, text: "**ููุงุฐุง ูุนููุ** ูุฌูู ููุถุงู SYN ููุฏู ุฅูู ุงุณุชููุงุฏ 'ูุงุฆูุฉ ุงูุชุธุงุฑ' ุงูุงุชุตุงูุงุช ุงููุนููุฉ ูู ุงูุฎุงุฏู ุนู ุทุฑูู ุฅุฑุณุงู ุนุฏุฏ ูุจูุฑ ูู ุญุฒู SYN ุงูุฃูููุฉ ุฏูู ุฅููุงู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ. ุนูุฏูุง ุชููู `tcp_syncookies` ูููููุฉ ูุชูุชูุฆ ูุงุฆูุฉ ุงูุงูุชุธุงุฑุ ูุง ูููู ุงูุฎุงุฏู ุจุชุฎุตูุต ุฐุงูุฑุฉ ููุงุชุตุงู ุงูุฌุฏูุฏ. ุจุฏูุงู ูู ุฐููุ ูุฅูู ูุฑุณู ุงุณุชุฌุงุจุฉ SYN-ACK ุฎุงุตุฉ ุชุญุชูู ุนูู ุฌููุน ุงููุนูููุงุช ุงููุงุฒูุฉ ูุดูุฑุฉ ูู ุฑูู ุงูุชุณูุณู (`syncookie`). ุฅุฐุง ูุงู ุงูุนููู ุดุฑุนููุงุ ูุณูุฑุฏ ุจุงูุฑูู ุงูุตุญูุญุ ููููู ููุฎุงุฏู ุฅุนุงุฏุฉ ุจูุงุก ุงูุงุชุตุงู ูู ุงูุตูุฑ. ูุฐุง ูุณูุญ ููุฎุงุฏู ุจุงูุงุณุชูุฑุงุฑ ูู ูุจูู ุงูุงุชุตุงูุงุช ุงูุดุฑุนูุฉ ุญุชู ุฃุซูุงุก ุชุนุฑุถู ููุฌูู." },
                { type: ContentType.PARAGRAPH, text: "ูุชุทุจูู ุงูุชุบููุฑุงุช: `sudo sysctl -p`." },
              ]
            },
            {
              id: "p4_c3_s4",
              icon: "๐",
              title: "ุงููุณุชูู 88: ูุฑุดุฉ ุนูู ุชุฏููู ุงูุฃุฐููุงุช: ุงูุนุซูุฑ ุนูู ุฃุจูุงุจ ุฎูููุฉ",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูููู ุฃู ุชููู ุงูุฃุฐููุงุช ุบูุฑ ุงูุตุญูุญุฉ ูููููุงุช ุจูุซุงุจุฉ ูุงูู ูุชุตุนูุฏ ุงูุงูุชูุงุฒุงุช. **ุงูุณููุงุฑูู:** ูุงู ูุณุคูู ูุธุงู ุณุงุจู ุจุชุฑู ูุต ุจุฑูุฌู 'ูุณุงุนุฏ' ูู `/usr/local/bin/cleanup.sh` ููุณุงุนุฏุชู ูู ุชูุธูู ุณุฌูุงุช `root`. ูุชุณููู ุงูุฃููุฑุ ูุงู ุจุชุนููู ุจุช SUID ุนููู." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 1: ุงูุจุญุซ ุนู ูููุงุช SUID ุงููุดุจููุฉ" },
                { type: ContentType.PARAGRAPH, text: "ูููุงุช SUID (Set User ID) ูู ูููุงุช ูุชู ุชูููุฐูุง ุจุตูุงุญูุงุช ุงููุงููุ ูููุณ ุงููุณุชุฎุฏู ุงูุฐู ูุงู ุจุชุดุบูููุง. ูุฐุง ุถุฑูุฑู ูุฃุฏูุงุช ูุซู `passwd`ุ ููููู ุฎุทูุฑ ููุบุงูุฉ ูููููุงุช ุงููุฎุตุตุฉ." },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `find / -type f -perm -4000 -exec ls -l {} \\; 2>/dev/null`},
                { type: ContentType.PARAGRAPH, text: "ูู ุงููุฎุฑุฌุงุชุ ุชุฑู `/usr/local/bin/cleanup.sh` ููููููุง ูู `root` ููุนู ุจุช SUID. ูุฐุง ุฃูุฑ ุบูุฑ ุนุงุฏู ููุบุงูุฉ ููุต ุจุฑูุฌู." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ูุญุต ุงูููู ูุงูุงุณุชุบูุงู" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `cat /usr/local/bin/cleanup.sh`},
                { type: ContentType.PREFORMATTED_TEXT, text: `#!/bin/bash
rm -rf /var/log/oldlogs/*`},
                { type: ContentType.PARAGRAPH, text: "ูุจุฏู ุจุฑูุฆูุง. ูููู ูุธุฑูุง ูุฃูู ูุชู ุชุดุบููู ูู `root` ููุณุชุฎุฏู ูุณุงุฑูุง ูุณุจููุง (`rm`)ุ ูููููุง ุงุณุชุบูุงู ููููุฉ ุนูู ูุชุบูุฑ `PATH` ูู ุงููุตูุต ุงูุจุฑูุฌูุฉ." },
                { type: ContentType.PARAGRAPH, text: "ููุณุชุฎุฏู ุนุงุฏูุ ูููู ุจุงูุขุชู:" },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `cd /tmp
echo "/bin/bash" > rm
chmod +x rm
export PATH=/tmp:$PATH
/usr/local/bin/cleanup.sh`},
                { type: ContentType.PARAGRAPH, text: "**ูุงุฐุง ุญุฏุซุ** ุนูุฏูุง ูููู ุงููุต ุงูุจุฑูุฌู `cleanup.sh` (ุงูุฐู ูุนูู ูู `root`) ุจุงุณุชุฏุนุงุก `rm`ุ ูุฅูู ูุจุญุซ ูู `PATH` ุงูุฎุงุต ุจูุง ุฃููุงู. ูุฌุฏ `/tmp/rm`ุ ููู ูู ุงููุงูุน ูุฌุฑุฏ ูุต ุจุฑูุฌู ูููู ุจุชุดุบูู `bash`. ูุธุฑูุง ูุฃู ุงููุต ุงูุฃุตูู ูุนูู ูู `root`ุ ูุฅู ูุฐุง ุงูู `bash` ุงูุฌุฏูุฏ ูุชู ุชุดุบููู ุฃูุถูุง ูู `root`. ููุฏ ุญุตูุช ููุชู ุนูู ุฌูุณุฉ `root`." },
                { type: ContentType.HEADING4, text: "ุงูุฅุตูุงุญ:" },
                { type: ContentType.LIST_UNORDERED, items: [
                    "<strong>ุงูุตุญูุญ:</strong> `sudo chmod u-s /usr/local/bin/cleanup.sh` (ุฅุฒุงูุฉ ุจุช SUID).",
                    "<strong>ุงูุฃูุถู:</strong> ุญุฐู ุงููุต ุงูุจุฑูุฌู ุบูุฑ ุงูุถุฑูุฑู."
                ]},
              ]
            },
            {
                id: "p4_c3_s5",
                icon: "๐พ",
                title: "ุงููุณุชูู 89: ุชุฃููู ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ (`/dev/shm`)",
                content: [
                  { type: ContentType.PARAGRAPH, text: "`/dev/shm` ูู ูุธุงู ูููุงุช ูุคูุช ูุชู ุชุฎุฒููู ุจุงููุงูู ูู ุงูุฐุงูุฑุฉ (tmpfs). ุชุณุชุฎุฏูู ุจุนุถ ุงูุชุทุจููุงุช (ูุซู ูุชุตูุญุงุช ุงูููุจ ุฃู ููุงุนุฏ ุงูุจูุงูุงุช) ููุงุชุตุงู ุจูู ุงูุนูููุงุช ุจุณุฑุนุฉ. ุงููุดููุฉ ูู ุฃูู ุจุดูู ุงูุชุฑุงุถูุ ูููู ุชุฑููุจู ูุน ุฃุฐููุงุช ุชุณูุญ ุจุงูุชูููุฐ." },
                  { type: ContentType.HEADING4, text: "ุงูุชูุฏูุฏ" },
                  { type: ContentType.PARAGRAPH, text: "ูููู ููููุงุฌู ุงูุฐู ุญุตู ุนูู ูุตูู ููุฎูุถ ุงูุงูุชูุงุฒุงุช ุงุณุชุฎุฏุงู `/dev/shm` ูุชูุฒูู ูุชุฌููุน ูุชุดุบูู ุจุฑุงูุฌ ุถุงุฑุฉ. ูุธุฑูุง ูุฃูู ูู ุงูุฐุงูุฑุฉุ ููุฏ ูุชุฌูุจ ุจุนุถ ุฃุฏูุงุช ุงููุญุต ุงููุณุชูุฏุฉ ุฅูู ุงููุฑุต." },
                  { type: ContentType.HEADING4, text: "ุงูุญู: ุฅุนุงุฏุฉ ุงูุชุฑููุจ ูุน ุฎูุงุฑุงุช ุขููุฉ" },
                  { type: ContentType.PARAGRAPH, text: "ูููููุง ุถูุงู ุฃู `/dev/shm` ูุชู ุชุฑููุจู ุฏุงุฆููุง ุจุฎูุงุฑุงุช ุขููุฉ ุนู ุทุฑูู ุฅุถุงูุฉ ุฅุฏุฎุงู ุฅูู `/etc/fstab`. ูุฐุง ุงูููู ูุญุฏุฏ ููููุฉ ุชุฑููุจ ุฃูุธูุฉ ุงููููุงุช ุนูุฏ ุจุฏุก ุงูุชุดุบูู." },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `echo "tmpfs /dev/shm tmpfs defaults,noexec,nosuid,nodev 0 0" | sudo tee -a /etc/fstab` },
                  { type: ContentType.DEFINITION_LIST, definitionItems: [
                      { term: "noexec", definition: "ูููุน ุชูููุฐ ุฃู ูููุงุช ุซูุงุฆูุฉ ูู ูุฐุง ุงููููุน." },
                      { term: "nosuid", definition: "ูุชุฌุงูู ุจุชุงุช SUID/SGID." },
                      { term: "nodev", definition: "ูููุน ุฅูุดุงุก ูููุงุช ุงูุฃุฌูุฒุฉ." }
                  ] },
                  { type: ContentType.PARAGRAPH, text: "ููุชุทุจูู ููุฑูุง ุฏูู ุฅุนุงุฏุฉ ุงูุชุดุบูู: `sudo mount -o remount /dev/shm`." },
                ]
            }
        ]
    },
     {
        id: "p4_c4", chapterTitle: "ุงููุตู ุงูุชุงุณุน ุนุดุฑ: ุฃูุงู ุงูุชุทุจููุงุช",
        sections: [
            {
              id: "p4_c4_s1",
              icon: "๐",
              title: "ุงููุณุชูู 90: ุฏุฑุงุณุฉ ุญุงูุฉ: XSS, CSRF, SQLi",
              content: [
                { type: ContentType.HEADING4, text: "ุญูู SQL: ูู ุณูุก ุฅูู ุฌูุฏ" },
                { type: ContentType.PARAGRAPH, text: "**ุณูุก (Node.js):** ูุชู ุจูุงุก ุงูุงุณุชุนูุงู ุนู ุทุฑูู ุฑุจุท ุงูุณูุงุณู ูุจุงุดุฑุฉ. ุฅุฐุง ูุงู `req.query.category` ูู `' OR 1=1; --`ุ ูุณูุชู ุฅุฑุฌุงุน ุฌููุน ุงูููุชุฌุงุช." },
                { type: ContentType.CODE_BLOCK, language: "javascript", code: `const query = \`SELECT * FROM products WHERE category = '\${req.query.category}'\`;
const { rows } = await pool.query(query);` },
                { type: ContentType.PARAGRAPH, text: "**ุฌูุฏ (Node.js):** ูุณุชุฎุฏู ุงุณุชุนูุงูุงุช ุฐุงุช ูุนููุงุช (Parameterized Queries). ูุชู ุฅุฑุณุงู ุงูุงุณุชุนูุงู ูุงูุจูุงูุงุช ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุดูู ูููุตู. ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุงููุณุคููุฉ ุนู ุงููุฑูุจ ุงูุขูู ููุจูุงูุงุช." },
                { type: ContentType.CODE_BLOCK, language: "javascript", code: `const query = 'SELECT * FROM products WHERE category = $1';
const { rows } = await pool.query(query, [req.query.category]);` },
                { type: ContentType.HEADING4, text: "ุงูุจุฑูุฌุฉ ุงููุตูุฉ ุนุจุฑ ุงูููุงูุน (XSS): ูู ุณูุก ุฅูู ุฌูุฏ" },
                { type: ContentType.PARAGRAPH, text: "**ุณูุก (React):** ุงุณุชุฎุฏุงู `dangerouslySetInnerHTML` ุฏูู ุชุนููู ุงููุฏุฎูุงุช. ุฅุฐุง ูุงู `comment.text` ูุญุชูู ุนูู `<img src=x onerror=alert('XSS')>`ุ ูุณูุชู ุชูููุฐู." },
                { type: ContentType.CODE_BLOCK, language: "jsx", code: `<div dangerouslySetInnerHTML={{ __html: comment.text }} />` },
                { type: ContentType.PARAGRAPH, text: "**ุฌูุฏ (React):** ุจุดูู ุงูุชุฑุงุถูุ ูููู React ุจุงููุฑูุจ ูู ูู ุดูุก. ุจุจุณุงุทุฉ ูู ุจุนุฑุถ ุงููุญุชูู. ุณูุชู ุนุฑุถู ููุต." },
                { type: ContentType.CODE_BLOCK, language: "jsx", code: `<div>{comment.text}</div>` },
                { type: ContentType.HEADING4, text: "ุชุฒููุฑ ุงูุทูุจุงุช ุนุจุฑ ุงูููุงูุน (CSRF): ูู ุณูุก ุฅูู ุฌูุฏ" },
                { type: ContentType.PARAGRAPH, text: "**ุณูุก:** ูููุฐุฌ ุจุณูุท ูุชุบููุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู. ุฅุฐุง ูุงู ูุณุชุฎุฏู ูุณุฌู ุฏุฎููู ุจุฒูุงุฑุฉ ูููุน ุถุงุฑ ูุญุชูู ุนูู ูููุฐุฌ ูุฎูู ูุชู ุฅุฑุณุงูู ุชููุงุฆููุง ุฅูู `/update-email`ุ ูุณูุชู ุชุบููุฑ ุจุฑูุฏู ุงูุฅููุชุฑููู ุฏูู ุนููู." },
                { type: ContentType.CODE_BLOCK, language: "html", code: `<form action="/update-email" method="POST">
  <input type="email" name="email" value="hacker@example.com">
</form>` },
                 { type: ContentType.PARAGRAPH, text: "**ุฌูุฏ (Express.js):** ูุณุชุฎุฏู middleware ูุซู `csurf` ูุฅูุดุงุก ุฑูุฒ ูุฑูุฏ ููู ุฌูุณุฉ. ูุฌุจ ุชุถููู ูุฐุง ุงูุฑูุฒ ูู ูู ุทูุจ POST." },
                { type: ContentType.CODE_BLOCK, language: "javascript", code: `// In your form (rendered by server)
<input type="hidden" name="_csrf" value="<%= csrfToken %>">

// In your server middleware
const csrfProtection = csrf({ cookie: true });
app.post('/update-email', csrfProtection, (req, res) => {
  // ... update email ...
});` },
              ]
            },
            {
              id: "p4_c4_s2",
              icon: "๐ท๏ธ",
              title: "ุงููุณุชูู 91: ูุฑุดุฉ ุนูู ุชุฑููุณุงุช ุงูุฃูุงู: ุจูุงุก ุญุตู",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูููู ุชูููู ุชุฑููุณุงุช ุงูุฃูุงู ูู Nginx ูููุน ูุฆุงุช ูุงููุฉ ูู ุงููุฌูุงุช. ูููู ุจุจูุงุก ููุชุทู ููู." },
                { type: ContentType.CODE_EXPLANATION, language: "nginx", codeTitle: "/etc/nginx/snippets/security-headers.conf", code: `# HSTS (HTTP Strict Transport Security) for 1 year
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# Prevent MIME-sniffing
add_header X-Content-Type-Options "nosniff" always;

# Prevent Clickjacking
add_header X-Frame-Options "SAMEORIGIN" always;

# Control information shared with other sites
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# A very strict Content-Security-Policy (CSP) as a starting point
# This allows resources only from the same origin. You will likely need to expand this.
add_header Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self'; form-action 'self';" always;`, explanations: [
                    { lines: "2", explanation: "ููุฑุถ HTTPSุ ููุง ุชูุช ููุงูุดุชู ุณุงุจููุง." },
                    { lines: "5", explanation: "ูููุน ุงููุชุตูุญ ูู ูุญุงููุฉ ุชุฎููู ููุน ุงููุญุชููุ ููุง ูุญูู ูู ูุฌูุงุช XSS." },
                    { lines: "8", explanation: "ูููุน ุชุญููู ูููุนู ุฏุงุฎู `<iframe>` ุนูู ูููุน ุขุฎุฑ." },
                    { lines: "11", explanation: "ูุชุญูู ูู ููุฏุงุฑ ุงููุนูููุงุช ุงููุฑุฌุนูุฉ ุงูุชู ูุชู ุฅุฑุณุงููุง ุนูุฏ ุงูููุฑ ุนูู ุฑุงุจุท." },
                    { lines: "14-16", explanation: "ูุฐู ูู ุณูุงุณุฉ ุฃูุงู ุงููุญุชูู (CSP). ูุฐู ุงูุณูุงุณุฉ ุงููุญุฏุฏุฉ ุตุงุฑูุฉ ููุบุงูุฉ. ุฅููุง ุชููุน ุชุญููู ุฃู ูุตูุต ุจุฑูุฌูุฉ ุฃู ุฃููุงุท ุฃู ุตูุฑ ูู ูุทุงูุงุช ุฎุงุฑุฌูุฉ. ุณุชุญุชุงุฌ ุนูู ุงูุฃุฑุฌุญ ุฅูู ุชุนุฏูููุง ูุชุดูู ูุทุงูุงุช CDN ุฃู Google Fonts ุงูุชู ุชุณุชุฎุฏููุง." }
                ]},
                { type: ContentType.PARAGRAPH, text: "ููููู ุจุนุฏ ุฐูู ุชุถููู ูุฐุง ุงูููู ูู ูุชูุฉ ุงูุฎุงุฏู ุงูุฎุงุตุฉ ุจู: `include /etc/nginx/snippets/security-headers.conf;`." },
              ]
            },
            {
                id: "p4_c4_s3",
                icon: "โ",
                title: "ุงููุณุชูู 92: ุงูุชุญูู ูู ุตุญุฉ ุงููุฏุฎูุงุช ูููุน ูุฌูุงุช ุงูุญูู",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ุงูุชุญูู ูู ุตุญุฉ ุงููุฏุฎูุงุช ูู ุฃูุซุฑ ูู ูุฌุฑุฏ ููุน ุญูู SQL. ูุชุนูู ุงูุฃูุฑ ุจูุฑุถ ููุงุนุฏ ุตุงุฑูุฉ ุนูู ูู ุฌุฒุก ูู ุงูุจูุงูุงุช ุงูุชู ุชุฏุฎู ูุธุงูู. ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ ูู: **ูุง ุชุซู ุฃุจุฏูุง ูู ูุฏุฎูุงุช ุงููุณุชุฎุฏู**." },
                  { type: ContentType.HEADING4, text: "ูุณุชููุงุช ุงูุชุญูู ูู ุงูุตุญุฉ" },
                  { type: ContentType.LIST_UNORDERED, items: [
                      "<strong>ุงูุชุญูู ูู ุงูุตุญุฉ ูู ุฌุงูุจ ุงูุนููู (Client-side):</strong> ุจุงุณุชุฎุฏุงู ุณูุงุช HTML5 (`required`, `type='email'`) ุฃู JavaScript. ูุฐุง ุฌูุฏ ูุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏูุ ููููู **ููุณ ุฅุฌุฑุงุกู ุฃููููุง**. ูููู ููููุงุฌู ุชุฌุงูุฒู ุจุณูููุฉ.",
                      "<strong>ุงูุชุญูู ูู ุงูุตุญุฉ ูู ุฌุงูุจ ุงูุฎุงุฏู (Server-side):</strong> ูุฐุง ูู ุงูููุงู ุงูุฐู ูุญุฏุซ ููู ุงูุฃูุงู ุงูุญูููู. ูุฌุจ ุฃู ูุชุญูู ุงูุฎุงุฏู ุฏุงุฆููุง ูู ุตุญุฉ ูู ุดูุกุ ุญุชู ูู ุชู ุงูุชุญูู ููู ุจุงููุนู ุนูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ."
                  ] },
                  { type: ContentType.HEADING4, text: "ุฏุฑุงุณุฉ ุญุงูุฉ: ุงุณุชุฎุฏุงู `express-validator`" },
                  { type: ContentType.CODE_BLOCK, language: "javascript", code: `const { body, validationResult } = require('express-validator');

app.post('/register',
  // Middleware ููุชุญูู ูู ุงูุตุญุฉ
  body('email').isEmail().normalizeEmail(),
  body('password').isLength({ min: 8 }).withMessage('Password must be at least 8 chars long'),
  body('age').isInt({ min: 18, max: 99 }),

  (req, res) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }
    // ... proceed with registration ...
  }
);` },
                ]
            },
            {
                id: "p4_c4_s4",
                icon: "๐ช",
                title: "ุงููุณุชูู 93: ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ููููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุจุฃูุงู",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ุงูุฌูุณุงุช ูู ุฐุงูุฑุฉ ุชุทุจูู ุงูููุจ. ุฅุฏุงุฑุชูุง ุจุดูู ุบูุฑ ุขูู ูููู ุฃู ุชุคุฏู ุฅูู ุงุฎุชุทุงู ุงูุฌูุณุฉ (session hijacking)." },
                  { type: ContentType.HEADING4, text: "ุฃูุถู ููุงุฑุณุงุช ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ููุฌูุณุงุช" },
                  { type: ContentType.PARAGRAPH, text: "ุนูุฏ ุชูููู middleware ุงูุฌูุณุฉ (ูุซู `express-session`)ุ ุงุณุชุฎุฏู ุฏุงุฆููุง ูุฐู ุงูุฎูุงุฑุงุช ููุฅูุชุงุฌ:" },
                  { type: ContentType.CODE_BLOCK, language: "javascript", code: `cookie: {
  secure: true,       // Only send cookie over HTTPS
  httpOnly: true,     // Prevent JavaScript access to the cookie
  sameSite: 'lax'     // Mitigates CSRF attacks. 'strict' is even better.
}` },
                  { type: ContentType.HEADING4, text: "ุงูุชุฎุฒูู ูู ุฌุงูุจ ุงูุฎุงุฏู ูู ุงูููู" },
                  { type: ContentType.PARAGRAPH, text: "ุชุฌูุจ ุชุฎุฒูู ุฃู ุจูุงูุงุช ุญุณุงุณุฉ ูู JWTs ูู ุฌุงูุจ ุงูุนููู. JWTs ุฑุงุฆุนุฉ ูููุตุงุฏูุฉ ุจูู ุงูุฎุฏูุงุชุ ูููู ููุฌูุณุงุชุ ูู ุงูุฃูุถู ุชุฎุฒูู ูุนุฑู ุฌูุณุฉ ุนุดูุงุฆู ูุบูุฑ ุดูุงู ููุท ูู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุทุ ูุชุฎุฒูู ุฌููุน ุจูุงูุงุช ุงูุฌูุณุฉ ุงููุนููุฉ ูู ูุฎุฒู ูู ุฌุงูุจ ุงูุฎุงุฏู ูุซู Redis. ูุฐุง ูุณูุญ ูู ุจุฅูุบุงุก ุฌูุณุฉ ุนูู ุงูููุฑ ุนู ุทุฑูู ุญุฐููุง ูู Redis." },
                ]
            },
            {
              id: "p4_c4_s5",
              icon: "๐",
              title: "ุงููุณุชูู 94: ุฏุฑุงุณุฉ ุญุงูุฉ OWASP: ุงูุชุญูู ูู ุงููุตูู ุงููุนุทู",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูุฐุง ูู ุงูุฎุทุฑ ุงูุฃููู ุฑูู 1 ูู ูุงุฆูุฉ OWASP Top 10 ูุนุงู 2021. **ุงูุณููุงุฑูู:** ูุฏููุง ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ููุญุตูู ุนูู ุชูุงุตูู ุงูุทูุจ: `GET /api/orders/:orderId`." },
                { type: ContentType.PARAGRAPH, text: "**ุงูููุฏ ุงูุณูุก (Vulnerable Code):**" },
                { type: ContentType.CODE_BLOCK, language: "javascript", code: `// User Alice is logged in (session.userId = 1)
// She requests /api/orders/99, which belongs to User Bob (userId = 2)

app.get('/api/orders/:orderId', (req, res) => {
  const { orderId } = req.params;
  // The fatal flaw: The query only checks for the order ID.
  const order = db.query('SELECT * FROM orders WHERE id = $1', [orderId]);
  
  if (order) {
    res.json(order);
  } else {
    res.sendStatus(404);
  }
});` },
                { type: ContentType.PARAGRAPH, text: "ุงููุดููุฉ ูู ุฃู ุงูููุฏ ูุง ูุชุญูู ุฃุจุฏูุง ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุงููุณุฌู ุฏุฎููู *ูููู* ุงูุทูุจ ุงูุฐู ูุทูุจู. ูููู ูู Alice ุจุจุณุงุทุฉ ุชุฎููู ูุนุฑูุงุช ุงูุทูุจุงุช ูููุตูู ุฅูู ุจูุงูุงุช Bob." },
                { type: ContentType.PARAGRAPH, text: "**ุงูููุฏ ุงูุฌูุฏ (Patched Code):**" },
                { type: ContentType.CODE_BLOCK, language: "javascript", code: `app.get('/api/orders/:orderId', (req, res) => {
  const { orderId } = req.params;
  const { userId } = req.session; // Get the user ID from the trusted session
  
  // The fix: The query now checks for BOTH the order ID AND the owner ID.
  const order = db.query('SELECT * FROM orders WHERE id = $1 AND user_id = $2', [orderId, userId]);

  if (order) {
    res.json(order);
  } else {
    // Return 404 even if the order exists but belongs to someone else.
    // This prevents leaking information.
    res.sendStatus(404);
  }
});` },
              ]
            }
        ]
    },
     {
        id: "p4_c5", chapterTitle: "ุงููุตู ุงูุนุดุฑูู: ุฃูุงู ุงูุดุจูุฉ ุงููุชูุฏู",
        sections: [
            {
                id: "p4_c5_s1",
                icon: "๐ฅ",
                title: "ุงููุณุชูู 95: ููู `iptables` ูุงููุฑู ุจููู ูุจูู UFW",
                content: [
                  { type: ContentType.PARAGRAPH, text: "`iptables` ูู ุฌุฏุงุฑ ุงูุญูุงูุฉ ุงููุนูู ูู ููุงุฉ ููููุณ. ุฅูู ููู ููุบุงูุฉ ููููู ูุนูุฏ. UFW ูู ูุงุฌูุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู ุชููู ุจุฅูุดุงุก ููุงุนุฏ `iptables` ูู. ููู ุงูุฃุณุงุณูุงุช ูููุญู ุงููุฒูุฏ ูู ุงูููุฉ." },
                  { type: ContentType.HEADING4, text: "ุชุดุฑูุญ `iptables`" },
                  { type: ContentType.DEFINITION_LIST, definitionItems: [
                      { term: "ุงูุฌุฏุงูู (Tables)", definition: "ุญุงููุงุช ููููุงุนุฏ. ุงูุฌุฏูู ุงูุฃูุซุฑ ุดููุนูุง ูู `filter` (ููุณูุงุญ/ุงูุฑูุถ)." },
                      { term: "ุงูุณูุงุณู (Chains)", definition: "ููุงุฆู ูู ุงูููุงุนุฏ ุฏุงุฎู ุฌุฏูู. ุงูุณูุงุณู ุงููุฏูุฌุฉ ุงูุฑุฆูุณูุฉ ูู `INPUT` (ููุญุฑูุฉ ุงููุงุฑุฏุฉ ุฅูู ุงูุฎุงุฏู)ุ ู `OUTPUT` (ููุญุฑูุฉ ุงูุตุงุฏุฑุฉ)ุ ู `FORWARD` (ููุญุฑูุฉ ุงูุชู ูุชู ุชูุฌูููุง ุนุจุฑ ุงูุฎุงุฏู)." },
                      { term: "ุงูููุงุนุฏ (Rules)", definition: "ุชุทุงุจู ุงูุญุฒู ูุชุชุฎุฐ ุฅุฌุฑุงุกู (`ACCEPT`, `DROP`, `REJECT`)." }
                  ] },
                  { type: ContentType.PARAGRAPH, text: "ุนูุฏูุง ุชููู ุจุชุดุบูู `sudo ufw allow 22`ุ ูููู UFW ูู ุงูุฎูููุฉ ุจุฅุถุงูุฉ ูุงุนุฏุฉ ุฅูู ุณูุณูุฉ `INPUT` ูู ุฌุฏูู `filter` ุชุจุฏู ูู `-A INPUT -p tcp --dport 22 -j ACCEPT`." },
                ]
            },
            {
                id: "p4_c5_s2",
                icon: "๐ง",
                title: "ุงููุณุชูู 96: ุฏุฑุงุณุฉ ุญุงูุฉ: ุงูุญุฏ ูู ูุนุฏู SSH ุจุงุณุชุฎุฏุงู `iptables`",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ูุฐู ูููุฉ ูุง ูููู ูู UFW ุงูููุงู ุจูุง ุจุณูููุฉุ ููู `iptables` ูุชููู ูููุง. ุณููุดุฆ ูุงุนุฏุฉ ุชุญุฏ ูู ูุญุงููุงุช ุงูุงุชุตุงู ุงูุฌุฏูุฏุฉ ุจู SSH ุฅูู 4 ูู ุงูุฏูููุฉ." },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `# ุฃูุดุฆ ุณูุณูุฉ ุฌุฏูุฏุฉ ูุฎุตุตุฉ
sudo iptables -N SSH_BRUTE_FORCE

# ุฃุถู ูุงุนุฏุฉ ููููุฒ ุฅูู ุงูุณูุณูุฉ ุงูุฌุฏูุฏุฉ ูุงุชุตุงูุงุช SSH ุงูุฌุฏูุฏุฉ
sudo iptables -A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW -j SSH_BRUTE_FORCE

# ูู ุงูุณูุณูุฉ ุงูุฌุฏูุฏุฉุ ุงุณูุญ ุจู 4 ุงุชุตุงูุงุช ูู ุงูุฏูููุฉ
sudo iptables -A SSH_BRUTE_FORCE -m recent --set --name SSH
sudo iptables -A SSH_BRUTE_FORCE -m recent --update --seconds 60 --hitcount 4 --name SSH -j DROP

# ุฅุฐุง ูู ูุชู ุฅุณูุงุทูุงุ ุงุณูุญ ุจูุง
sudo iptables -A SSH_BRUTE_FORCE -j ACCEPT` },
                  { type: ContentType.PARAGRAPH, text: "ูุฐุง ูุณุชุฎุฏู ูุญุฏุฉ `recent` ูู `iptables` ูุชุชุจุน ุนูุงููู IP ุงูุชู ุชุชุตู ุญุฏูุซูุง." },
                ]
            },
            {
                id: "p4_c5_s3",
                icon: "๐",
                title: "ุงููุณุชูู 97: ุงูุญูุงูุฉ ูู ูุฌูุงุช DDoS ุงูุจุณูุทุฉ",
                content: [
                  { type: ContentType.PARAGRAPH, text: "ูููู ูู `iptables` ู `sysctl` ุงููุณุงุนุฏุฉ ูู ุงูุชุฎููู ูู ูุฌูุงุช ุญุฌุจ ุงูุฎุฏูุฉ (DDoS) ุงูุตุบูุฑุฉ." },
                  { type: ContentType.HEADING4, text: "ุญูุงูุฉ ููุถุงู SYN" },
                  { type: ContentType.PARAGRAPH, text: "ููุฏ ูุงูุดูุง `tcp_syncookies` ุจุงููุนู. ูููู ูู `iptables` ุงููุณุงุนุฏุฉ ุฃูุถูุง:" },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo iptables -A INPUT -p tcp --syn -m limit --limit 1/s --limit-burst 3 -j ACCEPT
sudo iptables -A INPUT -p tcp --syn -j DROP` },
                  { type: ContentType.PARAGRAPH, text: "ูุฐุง ูุณูุญ ููุท ุจูุนุฏู ูุญุฏูุฏ ูู ุญุฒู SYN ุงูุฌุฏูุฏุฉุ ููุณูุท ุงูุจุงูู." },
                  { type: ContentType.HEADING4, text: "ุญุธุฑ Ping of Death" },
                  { type: ContentType.CODE_BLOCK, language: "bash", code: `sudo iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
sudo iptables -A INPUT -p icmp --icmp-type echo-request -j DROP` },
                ]
            },
            {
              id: "p4_c5_s4",
              icon: "๐",
              title: "ุงููุณุชูู 98: ูุฑุดุฉ ุนูู WireGuard: ุญุตู ุฅุฏุงุฑู ูุงูู",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูุฐุง ูู ุงููุนูุงุฑ ุงูุฐูุจู ูุชุฃููู ุงููุตูู ุงูุฅุฏุงุฑู. ุณูุฌุนู ูููุฐ SSH ุงูุฎุงุต ุจูุง ุบูุฑ ูุฑุฆู ุชูุงููุง ููุฅูุชุฑูุช ุงูุนุงู. **ุงูุณููุงุฑูู:** ุฅุนุฏุงุฏ VPN WireGuard ูุฅุบูุงู SSH ุจุญูุซ ูุง ูููู ุงููุตูู ุฅููู ุฅูุง ูู ุฎูุงูู." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 1: ุชุซุจูุช WireGuard" },
                { type: ContentType.PARAGRAPH, text: "ุงุณุชุฎุฏู ูุตูุง ุจุฑูุฌููุง ููุซูููุง ูุซู [wireguard-install](https://github.com/Nyr/wireguard-install) ูุฃุชูุชุฉ ุงูุชุซุจูุช ุงููุงูู ููุฎุงุฏู. ุฅูู ูุชุนุงูู ูุน ุฅูุดุงุก ุงูููุงุชูุญ ูุชูููู `sysctl` ูุฅุนุฏุงุฏ ุงููุงุฌูุฉ." },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `curl -O https://raw.githubusercontent.com/Nyr/wireguard-install/master/wireguard-install.sh
chmod +x wireguard-install.sh
sudo ./wireguard-install.sh` },
                { type: ContentType.PARAGRAPH, text: "ุณูููู ุงููุต ุงูุจุฑูุฌู ุจุฅุฑุดุงุฏู ุฎูุงู ุงูุนูููุฉ. ุจุนุฏ ุงูุชูุงููุ ุณูููู ูุฏูู ููู ุชูููู ุนููู (ุนูู ุณุจูู ุงููุซุงู, `wg0-client-nagi.conf`)." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 2: ุชูููู ุงูุนููู" },
                { type: ContentType.PARAGRAPH, text: "ุงููู ููู `.conf` ุฅูู ุฌูุงุฒู ุงููุญูู ููู ุจุงุณุชูุฑุงุฏู ุฅูู ุนููู WireGuard ุงูุฎุงุต ุจู. ุงุชุตู ุจุงูู VPN. ูุฌุจ ุฃู ุชููู ูุงุฏุฑูุง ุนูู `ping` ุนููุงู IP ุงูุฏุงุฎูู ููุฎุงุฏู (ุนุงุฏุฉ `10.0.0.1`)." },
                { type: ContentType.HEADING4, text: "ุงูุฎุทูุฉ 3: ูุฑุดุฉ ุนูู UFW: ุฅุบูุงู ุงูุจูุงุจุฉ" },
                { type: ContentType.PARAGRAPH, text: "ูุฐู ูู ุงูุฎุทูุฉ ุงูุญุงุณูุฉ. ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ุจุงุจ ุฎููู ุขููุ ูููููุง ุฅุบูุงู ุงูุจุงุจ ุงูุฃูุงูู." },
                { type: ContentType.CODE_BLOCK, language: "bash", code: `# 1. ุงุนุฑุถ ุงูููุงุนุฏ ุงูุญุงููุฉ ุจุงูุฃุฑูุงู
sudo ufw status numbered

# 2. ุงุญุฐู ูุงุนุฏุฉ SSH ุงูุนุงูุฉ ุงููุฏููุฉ (ุนูู ุณุจูู ุงููุซุงู, ุฑูู 4)
sudo ufw delete 4

# 3. ุฃุถู ูุงุนุฏุฉ ุฌุฏูุฏุฉ ุชุณูุญ ุจู SSH ููุท ูู ุดุจูุฉ WireGuard ุงูุฏุงุฎููุฉ
# (ุงูุชุฑุถ ุฃู ุดุจูุชู ูู 10.0.0.0/24 ููููุฐ SSH ูู 2222)
sudo ufw allow from 10.0.0.0/24 to any port 2222 proto tcp

# 4. ุชุญูู ูู ุงูููุงุนุฏ ุงูุฌุฏูุฏุฉ
sudo ufw status` },
                { type: ContentType.NOTE, title: "ุงุฎุชุจุฑ ูุจู ูุทุน ุงูุงุชุตุงู!", text: "ุฃุซูุงุก ุงุชุตุงูู ุนุจุฑ SSH ุงูุนุงูุ ุงุชุตู ุจุงูู VPN ูู ูุงูุฐุฉ ุฃุฎุฑู ูุญุงูู ุงูุงุชุตุงู ุนุจุฑ SSH ุจุงุณุชุฎุฏุงู ุนููุงู IP *ุงูุฏุงุฎูู* ููุฎุงุฏู (`ssh nagi@10.0.0.1 -p 2222`). ููุท ุจุนุฏ ุฃู ุชุชุฃูุฏ ูู ุฃู ูุฐุง ูุนููุ ููููู ุจุฃูุงู ุญุฐู ูุงุนุฏุฉ SSH ุงูุนุงูุฉ." },
              ]
            },
            {
              id: "p4_c5_s5",
              icon: "๐ธ๏ธ",
              title: "ุงููุณุชูู 99: ุฏุฑุงุณุฉ ุญุงูุฉ ุนุฒู ุงูุดุจูุฉ: ุจููุฉ ุงูููุจ + ูุงุนุฏุฉ ุงูุจูุงูุงุช",
              content: [
                { type: ContentType.PARAGRAPH, text: "ูุน ููู ุชุทุจูููุ ุณุชุฑุบุจ ูู ูุตู ุฎุงุฏู ุงูููุจ ุงูุฎุงุต ุจู ุนู ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ุงูููุงู ุจุฐูู ุนุจุฑ ุงูุฅูุชุฑูุช ุงูุนุงู ุฃูุฑ ุบูุฑ ุขูู. ุงูุญู ูู ุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุฎุงุตุฉ (ุชุณูู ุฃุญูุงููุง VPCs ุฃู vRack)." },
                { type: ContentType.HEADING4, text: "ุงูุจููุฉ" },
                { type: ContentType.LIST_UNORDERED, items: [
                    "<strong>ุฎุงุฏู ุงูููุจ (web-1):</strong> ูุฏูู ูุงุฌูุชุง ุดุจูุฉ. ูุงุญุฏุฉ ุจุนููุงู IP ุนุงู (ูุซู `203.0.113.10`) ููุงุญุฏุฉ ุจุนููุงู IP ุฎุงุต (ูุซู `10.0.1.10`).",
                    "<strong>ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช (db-1):</strong> ูุฏูู ูุงุฌูุฉ ุดุจูุฉ ูุงุญุฏุฉ ููุท: ุนููุงู IP ุฎุงุต (ูุซู `10.0.1.20`). ููุณ ูุฏูู ุนููุงู IP ุนุงู ุนูู ุงูุฅุทูุงู."
                ]},
                { type: ContentType.HEADING4, text: "ุงูุชูููู" },
                { type: ContentType.PARAGRAPH, text: "1. **ูู ุชุทุจูู ุงูููุจ ุงูุฎุงุต ุจู:** ุณูุณูุฉ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุดูุฑ ุงูุขู ุฅูู ุนููุงู IP ุงูุฎุงุต: `postgres://user:pass@10.0.1.20/mydb`." },
                { type: ContentType.PARAGRAPH, text: "2. **ุนูู ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช (db-1):**" },
                { type: ContentType.LIST_UNORDERED, items: [
                    "ูู `postgresql.conf`ุ ูู ุจุชุนููู `listen_addresses = '10.0.1.20,localhost'` ููุงุณุชูุงุน ููุท ุนูู ุงููุงุฌูุฉ ุงูุฎุงุตุฉ.",
                    "ูู `pg_hba.conf`ุ ูู ุจุฅูุดุงุก ูุงุนุฏุฉ ููุณูุงุญ ุจุงูุงุชุตุงูุงุช ูู ุนููุงู IP ุงูุฎุงุต ุจุฎุงุฏู ุงูููุจ: `host all all 10.0.1.10/32 scram-sha-256`.",
                    "ูู UFWุ ุงุณูุญ ุจุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ ุนูู ุงููููุฐ 5432 ููุท ูู ุนููุงู IP ุงูุฎุงุต ุจุฎุงุฏู ุงูููุจ: `sudo ufw allow from 10.0.1.10 to any port 5432`."
                ]},
                { type: ContentType.PARAGRAPH, text: "ุงููุชูุฌุฉ ูู ุญุตู. ูุงุนุฏุฉ ุจูุงูุงุชูุ ููู ุฃูู ุฃุตูููุ ุบูุฑ ูุฑุฆูุฉ ุชูุงููุง ููุฅูุชุฑูุช ุงูุนุงู. ุงูุทุฑููุฉ ุงููุญูุฏุฉ ูููุตูู ุฅูููุง ูู ุนู ุทุฑูู ุงุฎุชุฑุงู ุฎุงุฏู ุงูููุจ ุฃููุงู. ูุฐุง ูููู ุจุดูู ูุจูุฑ ูู ุณุทุญ ุงููุฌูู ุงูุฎุงุต ุจู." },
              ]
            }
        ]
    }
  ]
};